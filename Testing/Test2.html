<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Secure Message Steganography - Project Explanation</title>
  <!-- Libraries -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"> <!-- Updated Font Awesome -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.21.2/babel.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js"></script> <!-- Lunr.js for Search -->
  <!-- Prism.js for Syntax Highlighting -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css" rel="stylesheet" /> <!-- Okaidia theme -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.css" rel="stylesheet" /> <!-- Toolbar CSS -->
 
  <style>
        /* --- Base & Variables --- */
        :root {
            --primary: #4f46e5;
            --primary-light: #818cf8;
            --primary-dark: #3730a3;
            --secondary: #06b6d4;
            --accent: #f472b6;
            --dark: #1e293b; /* Dark text / Light BG element */
            --light: #f8fafc; /* Light text / Dark BG element */
            --bg-light: #f8fafc;
            --bg-dark: #0f172a;
            --card-bg-light: rgba(255, 255, 255, 0.95);
            --card-bg-dark: rgba(30, 41, 59, 0.9); /* Slightly less transparent */
            --card-border-light: rgba(79, 70, 229, 0.1);
            --card-border-dark: rgba(129, 140, 248, 0.15);
            --code-bg-light: #f8f8f2; /* Light theme code background */
            --code-bg-dark: #282a36; /* Dark theme code background (Okaidia-like) */
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --container-shadow: var(--shadow-xl);
            --gradient: linear-gradient(135deg, var(--primary), var(--secondary));
            --text-light: #64748b; /* Lighter text for secondary info */
            --text-dark: var(--dark);
            --warning: #f97316; /* Orange for warnings */
            --error: #ef4444; /* Red for errors/low robustness */
            --success: #22c55e; /* Green for success/good */

            /* Tag Colors (Light Mode) */
            --tag-bg-default: rgba(79, 70, 229, 0.1);
            --tag-text-default: var(--primary);
            --tag-bg-security: hsla(0, 84%, 60%, 0.1);    /* Reddish */
            --tag-text-security: hsl(0, 74%, 50%);
            --tag-bg-advanced: hsla(270, 80%, 65%, 0.1);  /* Purplish */
            --tag-text-advanced: hsl(270, 70%, 55%);
            --tag-bg-encryption: hsla(217, 91%, 60%, 0.1); /* Blueish */
            --tag-text-encryption: hsl(217, 81%, 50%);
            --tag-bg-quality: hsla(145, 63%, 49%, 0.1);  /* Greenish */
            --tag-text-quality: hsl(145, 58%, 39%);
            --tag-bg-convenience: hsla(48, 96%, 59%, 0.1);/* Yellowish */
            --tag-text-convenience: hsl(48, 90%, 45%);
            --tag-bg-analysis: hsla(210, 40%, 50%, 0.1);  /* Grey-Blue */
            --tag-text-analysis: hsl(210, 30%, 40%);


            /* Default to light mode */
            --bg-main: var(--bg-light);
            --text-main: var(--text-dark);
            --text-muted: var(--text-light);
            --card-bg: var(--card-bg-light);
            --card-border: var(--card-border-light);
            --code-bg: var(--code-bg-light);

            /* Heading Colors */
            --h2-color-process: #4f46e5; /* Indigo for process-related headings */
            --h2-color-metrics: #06b6d4; /* Cyan for metrics-related headings */
            --h2-color-security: #ef4444; /* Red for security-related headings */
            --h2-color-technical: #f97316; /* Orange for technical headings */
            --h3-color-light: #64748b; /* Slate for light mode h3 */
            --h3-color-dark: #94a3b8; /* Slate for dark mode h3 */
        }
        #toc {
  width: 280px;
  padding: 2rem 1.5rem 2rem 0;
  position: sticky;
  top: 100px; 
  height: calc(100vh - 120px);
  overflow-y: auto;
  flex-shrink: 0;
  transition: transform 0.3s ease;
  border-right: 1px solid var(--card-border);
}
#toc {
  /* Existing styles */
  overflow-y: auto;
  /* Add these styles */
  scrollbar-width: thin; /* For Firefox */
  scrollbar-color: var(--primary) transparent; /* For Firefox */
}

/* For Webkit browsers (Chrome, Safari) */
#toc::-webkit-scrollbar {
  width: 8px;
}

#toc::-webkit-scrollbar-track {
  background: rgba(0,0,0,0.05);
  border-radius: 4px;
}

#toc::-webkit-scrollbar-thumb {
  background-color: var(--primary);
  border-radius: 4px;
}

/* Add a fade effect at the bottom to indicate more content */
#toc::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 30px;
  background: linear-gradient(to bottom, transparent, var(--card-bg));
  pointer-events: none;
  opacity: 0.8;
}
        .dark-mode {
            --primary: #818cf8;
            --primary-light: #a5b4fc;
            --primary-dark: #6366f1;
            --secondary: #22d3ee;
            --accent: #f9a8d4;
            --dark: #f8fafc; /* Dark text becomes light */
            --light: #0f172a; /* Light text becomes dark */
            --bg-main: var(--bg-dark);
            --text-main: var(--dark); /* Use light text on dark bg */
            --text-muted: #94a3b8; /* Adjusted muted text for dark */
            --card-bg: var(--card-bg-dark);
            --card-border: var(--card-border-dark);
            --code-bg: var(--code-bg-dark);
            --container-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.4), 0 10px 10px -5px rgba(0, 0, 0, 0.3);
            --warning: #fb923c; /* Lighter orange */
            --error: #f87171; /* Lighter red */
            --success: #4ade80; /* Lighter green */

             /* Tag Colors (Dark Mode) */
            --tag-bg-default: rgba(129, 140, 248, 0.15);
            --tag-text-default: var(--primary);
            --tag-bg-security: hsla(0, 84%, 70%, 0.15);
            --tag-text-security: hsl(0, 74%, 70%);
            --tag-bg-advanced: hsla(270, 80%, 75%, 0.15);
            --tag-text-advanced: hsl(270, 70%, 75%);
            --tag-bg-encryption: hsla(217, 91%, 70%, 0.15);
            --tag-text-encryption: hsl(217, 81%, 70%);
            --tag-bg-quality: hsla(145, 63%, 59%, 0.15);
            --tag-text-quality: hsl(145, 58%, 69%);
            --tag-bg-convenience: hsla(48, 96%, 69%, 0.15);
            --tag-text-convenience: hsl(48, 90%, 65%);
             --tag-bg-analysis: hsla(210, 40%, 70%, 0.15);
            --tag-text-analysis: hsl(210, 30%, 70%);
        }

        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth; /* Smooth scrolling for anchor links */
            scroll-padding-top: 100px; /* Adjust for sticky header/nav height */
        }


        body {
          font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
          background-color: var(--bg-main);
          color: var(--text-main);
          font-size: 18px; /* Base font size */
          line-height: 1.7; /* Increased line height for readability */
          transition: background-color 0.4s ease, color 0.4s ease;
          overflow-x: hidden; /* Prevent horizontal scroll */
        }

         /* Reduced motion preference */
        @media (prefers-reduced-motion: reduce) {
          html {
            scroll-behavior: auto; /* Disable smooth scrolling */
          }
          *, *::before, *::after {
            animation-duration: 0.01ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important;
            scroll-behavior: auto !important;
          }
          .logo-icon { animation: none; }
          .section { transition: none; opacity: 1; transform: none; }
        }

        /* --- Layout & Container --- */
        .page-wrapper {
            display: flex;
            flex-direction: column; /* Stack header, content */
            min-height: 100vh;
        }

        .content-wrapper {
            display: flex;
            flex: 1; /* Allow content to grow */
        }

        .main-content {
            flex: 1; /* Take remaining space */
            padding: 0 2rem; /* Padding around the main content area */
            max-width: 1200px; /* Max width for content readability */
            margin: 0 auto; /* Center the content block */
        }

        .container {
           width: 100%;
           margin: 0 auto; /* Center container */
        }

        /* --- Background Pattern --- */
        .bg-pattern {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          z-index: -1;
          opacity: 0.05; /* Further reduced opacity */
          pointer-events: none;
          background-image: radial-gradient(var(--primary) 0.5px, transparent 0.5px);
          background-size: 25px 25px; /* Slightly larger pattern */
          transition: opacity 0.4s ease;
        }
         .dark-mode .bg-pattern {
             opacity: 0.07;
             background-image: radial-gradient(var(--primary-light) 0.5px, transparent 0.5px);
         }

        /* --- Header --- */
        header {
          padding: 1.5rem 2rem; /* Consistent padding */
          border-bottom: 1px solid var(--card-border);
          display: flex;
          justify-content: space-between;
          align-items: center;
          position: sticky; /* Make header sticky */
          top: 0;
          background-color: var(--card-bg); /* Use card bg for backdrop */
          backdrop-filter: blur(12px);
          z-index: 50; /* Ensure header is above content but below modals/ToC toggle */
          transition: background-color 0.4s ease, border-color 0.4s ease;
        }

        .logo {
          display: flex;
          align-items: center;
          gap: 1rem;
        }

        .logo h1 {
          font-size: 1.8rem; /* Adjusted size */
          font-weight: 700;
          background: var(--gradient);
          -webkit-background-clip: text;
          background-clip: text;
          color: transparent;
        }

        .logo-icon {
          font-size: 2rem; /* Adjusted size */
          color: var(--primary);
          animation: pulse 2.5s infinite ease-in-out;
        }

        .header-buttons {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        /* Search Input in Header */
        .search-container {
            position: relative;
            display: none; /* Hide initially, show on larger screens */
        }
        .search-input {
            padding: 0.6rem 1rem 0.6rem 2.5rem; /* Space for icon */
            border-radius: 50px;
            border: 1px solid var(--card-border);
            background-color: rgba(129, 140, 248, 0.05); /* Subtle background */
            color: var(--text-main);
            font-size: 0.9rem;
            transition: all 0.3s ease;
            min-width: 200px; /* Minimum width */
        }
        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            background-color: var(--card-bg);
            box-shadow: 0 0 0 2px rgba(79, 70, 229, 0.2);
        }
        .search-container i {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        /* Theme Toggle Button */
        .theme-toggle {
          background: transparent;
          border: 1px solid var(--card-border);
          color: var(--text-muted);
          padding: 0.6rem 1.1rem;
          border-radius: 50px;
          cursor: pointer;
          display: flex;
          align-items: center;
          gap: 0.6rem;
          font-weight: 500;
          transition: all 0.3s ease;
          font-size: 0.9rem;
        }
        .theme-toggle:hover {
          color: var(--primary);
          border-color: var(--primary);
          background-color: rgba(79, 70, 229, 0.05);
        }
        .theme-toggle i { width: 1em; text-align: center; }

        /* Return Button */
        .return-button {
          display: inline-flex;
          align-items: center;
          gap: 0.6rem;
          background: transparent;
          border: 1px solid var(--card-border);
          color: var(--text-muted);
          padding: 0.6rem 1.1rem;
          border-radius: 50px;
          text-decoration: none;
          font-weight: 500;
          transition: all 0.3s ease;
          font-size: 0.9rem;
        }
        .return-button:hover {
          color: var(--secondary);
          border-color: var(--secondary);
          background-color: rgba(6, 182, 212, 0.05);
        }
        .return-button i { font-size: 0.9em; }

        /* --- Hero Section --- */
        #hero {
            padding: 6rem 2rem 4rem 2rem; /* Increased padding */
            text-align: center;
            position: relative;
            overflow: hidden;
            background: var(--gradient); /* Use gradient */
            color: white; /* Ensure text is visible on gradient */
            margin-bottom: 4rem; /* Spacing below hero */
            border-bottom: 1px solid rgba(255, 255, 255, 0.1); /* Subtle separator */
        }
        #hero::before { /* Optional overlay */
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(rgba(0,0,0,0.1), rgba(0,0,0,0.3)); /* Darken gradient slightly */
            z-index: 1;
        }
         #hero-content {
            position: relative;
            z-index: 2;
            max-width: 800px;
            margin: 0 auto;
        }
        #hero h1 {
            font-size: 3.5rem; /* Larger title */
            font-weight: 800;
            margin-bottom: 1rem;
            letter-spacing: -1px;
            color: white;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
             /* Override logo gradient style */
            background: none;
            -webkit-background-clip: initial;
            background-clip: initial;
        }
        #hero .tagline {
            font-size: 1.3rem;
            font-weight: 400;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 2rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        #hero .hero-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }
        #hero .hero-button {
            padding: 0.8rem 1.8rem;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 1rem;
            border: 1px solid transparent;
        }
        #hero .hero-button.primary {
            background-color: white;
            color: var(--primary);
            box-shadow: var(--shadow-md);
        }
        #hero .hero-button.primary:hover {
            background-color: rgba(255, 255, 255, 0.9);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
         #hero .hero-button.secondary {
            background-color: transparent;
            color: white;
            border-color: rgba(255, 255, 255, 0.5);
        }
        #hero .hero-button.secondary:hover {
            background-color: rgba(255, 255, 255, 0.1);
            border-color: white;
        }


        /* --- Table of Contents (ToC) --- */
        #toc {
          width: 280px; /* Fixed width for sidebar */
          padding: 2rem 1.5rem 2rem 0;
          position: sticky;
          top: 100px; /* Height of sticky header + some space */
          height: calc(100vh - 120px); /* Adjust based on header/footer */
          overflow-y: auto;
          flex-shrink: 0;
          transition: transform 0.3s ease;
          border-right: 1px solid var(--card-border);
        }
        #toc h3 {
          font-size: 1.1rem;
          font-weight: 600;
          margin-bottom: 1.5rem;
          color: var(--primary);
          padding-bottom: 0.5rem;
          border-bottom: 1px solid var(--card-border);
        }
        #toc ul {
          list-style: none;
          padding-left: 0;
        }
        #toc li {
          margin-bottom: 0.5rem;
        }
        #toc a {
          display: block;
          padding: 0.5rem 1rem;
          text-decoration: none;
          color: var(--text-muted);
          font-size: 0.95rem;
          border-radius: 6px;
          transition: all 0.2s ease;
          border-left: 3px solid transparent;
        }
        #toc a:hover {
          color: var(--primary);
          background-color: rgba(79, 70, 229, 0.05);
        }
        #toc a.active {
          color: var(--primary);
          font-weight: 600;
          background-color: rgba(79, 70, 229, 0.1);
          border-left-color: var(--primary);
        }
        /* Search results within ToC */
        #toc-search-results {
            margin-top: 1rem;
            font-size: 0.9em;
            border-top: 1px dashed var(--card-border);
            padding-top: 1rem;
        }
        #toc-search-results li a {
            font-style: italic;
            opacity: 0.8;
        }
        #toc-search-results li a:hover {
            opacity: 1;
        }

        /* Mobile ToC Toggle */
        .toc-toggle-mobile {
            display: none; /* Hidden by default */
            position: fixed;
            top: 80px; /* Below header */
            left: 1rem;
            z-index: 51; /* Above header content, below modal */
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            font-size: 1.1rem;
            cursor: pointer;
            box-shadow: var(--shadow-lg);
        }


        /* --- Sections --- */
        .section {
          padding: 2rem;
          margin: 2rem 0;
          background: var(--card-bg);
          border-radius: 1rem;
          box-shadow: var(--shadow-md);
          transition: all 0.4s ease;
          border: 1px solid var(--card-border);
          /* For fade-in animation */
          opacity: 0;
          transform: translateY(30px);
        }
        .section.visible { /* Class added by JS when intersecting */
          opacity: 1;
          transform: translateY(0);
        }

        .section:hover {
          /* Keep subtle hover (Optional) */
          /* transform: translateY(-5px); */
          /* box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15); */
        }

        .section-header {
          display: flex;
          align-items: center;
          gap: 1rem;
          margin-bottom: 2rem;
        }

        .section-header h2 {
          font-size: 2.2rem; /* Larger section headings */
          font-weight: 700;
          color: var(--primary);
          margin: 0; /* Remove default margin */
        }

        .section-header i {
          font-size: 1.5rem; /* Match heading size */
          color: var(--primary);
          background-color: rgba(79, 70, 229, 0.1);
          width: 50px; /* Adjusted size */
          height: 50px; /* Adjusted size */
          border-radius: 12px; /* Slightly less round */
          display: flex;
          align-items: center;
          justify-content: center;
          flex-shrink: 0;
        }
        .section > p:first-of-type { /* Style first paragraph after header */
            font-size: 1.15rem; /* Slightly larger intro text */
            color: var(--text-muted);
            margin-bottom: 2rem;
        }


        /* --- Feature Grid / Cards --- */
        .feature-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); /* Adjust minmax */
          gap: 2rem;
          margin-top: 2.5rem;
        }

        .feature-card {
          padding: 2rem;
          border-radius: 15px;
          background-color: var(--card-bg);
          backdrop-filter: blur(10px);
          box-shadow: var(--shadow-md);
          transition: all 0.3s ease;
          border: 1px solid var(--card-border);
          overflow: hidden; /* For potential background effects */
          display: flex;
          flex-direction: column; /* Stack content */
        }

        .feature-card:hover {
          transform: translateY(-6px) scale(1.02);
          box-shadow: var(--shadow-lg);
          border-color: var(--primary);
        }

        .feature-card h3 {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          margin-bottom: 1.2rem;
          /* Color defined by topic class below */
          font-size: 1.4rem; /* Slightly larger */
        }

         /* Topic-based H3 colors */
         .feature-card.topic-security h3 { color: var(--primary); }
         .feature-card.topic-stegano h3 { color: var(--secondary); }
         .feature-card.topic-key h3 { color: var(--accent); }
         .feature-card.topic-quality h3 { color: var(--success); } /* Use success color */

        .feature-card h3 i {
          font-size: 1.2rem; /* Adjusted */
          transition: transform 0.3s ease;
        }
        .feature-card:hover h3 i {
            transform: rotate(-10deg) scale(1.1);
        }
         .feature-card p {
            flex-grow: 1; /* Allow paragraph to take space */
            margin-bottom: 1.5rem; /* Space before tags */
        }


        /* --- Flowchart / Process Steps / Tabbed Sections --- */
        .flowchart-container, .tabbed-section-container { /* Shared container style */
          margin: 2rem 0;
          padding: 1.5rem;
          background: var(--card-bg);
          border-radius: 0.75rem;
          box-shadow: var(--shadow-sm);
          border: 1px solid var(--card-border);
          transition: background-color 0.4s ease, border-color 0.4s ease;
        }
         /* Remove top margin if it follows a section header directly */
        .section-header + .flowchart-container,
        .section-header + .tabbed-section-container {
            margin-top: 0;
        }

        .flowchart-tabs {
          display: flex;
          gap: 1rem;
          margin-bottom: 1.5rem;
        }

        .flowchart-tab {
          padding: 0.75rem 1.5rem;
          background: var(--card-bg);
          border: 1px solid var(--card-border);
          border-radius: 0.5rem;
          cursor: pointer;
          transition: all 0.3s ease;
        }

        .flowchart-tab.active {
          background: var(--primary);
          color: white;
          border-color: var(--primary);
        }

        .flowchart-content {
          display: none;
          opacity: 0;
          transform: translateY(15px);
          transition: opacity 0.4s ease, transform 0.4s ease;
        }

        .flowchart-content.active {
          display: block;
          opacity: 1;
          transform: translateY(0);
        }

        .chart {
          width: 100%;
          overflow-x: auto;
          padding: 1.5rem;
          background-color: var(--bg-main); /* Match body background */
          border-radius: 10px;
          transition: background-color 0.3s ease, border-color 0.3s ease;
          border: 1px solid var(--card-border);
        }

        /* Ensure SVG text/elements are readable in dark mode */
        .dark-mode .chart { border: 1px solid var(--card-border-dark); }
        .dark-mode .chart rect[fill="#ffffff"] { fill: var(--card-bg-dark); } /* Use card bg for contrast */
        .dark-mode .chart rect { stroke: var(--card-border-dark); }
        .dark-mode .chart text { fill: var(--text-main); } /* Use main text color */
        .dark-mode .chart line { stroke: var(--text-muted); }
        .dark-mode .chart marker path { fill: var(--text-muted); }
        /* Specific fills if needed */
         .dark-mode .chart rect[fill="#e0e7ff"] { fill: rgba(129, 140, 248, 0.1); stroke: rgba(129, 140, 248, 0.5); }
         .dark-mode .chart rect[fill="#e0f2fe"] { fill: rgba(56, 189, 248, 0.1); stroke: rgba(56, 189, 248, 0.5); }
         .dark-mode .chart rect[fill="#ecfdf5"] { fill: rgba(16, 185, 129, 0.1); stroke: rgba(16, 185, 129, 0.5); }
         .dark-mode .chart rect[fill="#f3e8ff"] { fill: rgba(168, 85, 247, 0.1); stroke: rgba(168, 85, 247, 0.5); }
         .dark-mode .chart circle[fill="#4f46e5"] { fill: var(--primary); }
         .dark-mode .chart circle[fill="#059669"] { fill: var(--success); }


        .process-step {
          display: flex;
          gap: 1.5rem;
          margin: 2rem 0;
          padding: 1.5rem;
          background: var(--card-bg);
          border-radius: 0.75rem;
          box-shadow: var(--shadow-sm);
          border: 1px solid var(--card-border);
          transition: all 0.3s ease;
          border: none; /* Remove border */
           border-bottom: 1px dashed var(--card-border); /* Dashed separator */
           position: relative; /* For potential line connector */
        }
        .flowchart-content > .process-step:last-child { /* Target last step inside content */
            border-bottom: none; /* No line after last step */
        }

        .step-number {
          width: 3rem;
          height: 3rem;
          display: flex;
          align-items: center;
          justify-content: center;
          background: var(--primary);
          color: white;
          border-radius: 50%;
          font-weight: bold;
          flex-shrink: 0;
          font-size: 1.1rem; /* Slightly larger */
          box-shadow: var(--shadow-sm);
          transition: transform 0.3s ease;
        }
         .process-step:hover .step-number {
             transform: scale(1.1);
         }

        .step-content {
          flex: 1;
        }

        .step-content h3 {
          margin-bottom: 0.75rem;
          font-size: 1.5rem; /* Larger step title */
          color: var(--primary);
        }

        /* Info Box Styling */
        .info-box {
          margin-top: 1.5rem; /* Increased margin */
          padding: 1.2rem 1.5rem; /* Adjusted padding */
          border-radius: 8px;
          background-color: rgba(79, 70, 229, 0.05);
          border-left: 4px solid var(--primary-light); /* Lighter border */
          font-size: 1rem; /* Increased font size */
          color: var(--text-muted);
        }
         .dark-mode .info-box {
             background-color: rgba(129, 140, 248, 0.08);
             border-left-color: var(--primary);
             color: var(--text-muted); /* Ensure muted text color is used */
         }
         .info-box ul, .info-box ol {
            list-style-position: inside;
            padding-left: 0.5rem;
            margin-top: 0.75rem; /* Consistent spacing */
        }
         .info-box li {
            margin-bottom: 0.6rem; /* Slightly more space */
        }
        .info-box p + ul, .info-box ul + p,
        .info-box p + ol, .info-box ol + p {
            margin-top: 1rem;
        }
        .info-box strong {
            color: var(--text-main); /* Ensure strong text is readable */
        }


         /* Info Box Styling */
         .info-box1 {
          height: 550px;
          width: 920px;
          margin-top: 1.5rem; /* Increased margin */
          padding: 1.2rem 1.5rem; /* Adjusted padding */
          border-radius: 8px;
          background-color: rgba(79, 70, 229, 0.05);
          border-left: 4px solid var(--primary-light); /* Lighter border */
          font-size: 1rem; /* Increased font size */
          color: var(--text-muted);
        }
         .dark-mode .info-box1 {
             background-color: rgba(129, 140, 248, 0.08);
             border-left-color: var(--primary);
             color: var(--text-muted); /* Ensure muted text color is used */
         }
         .info-box1 ul, .info-box1 ol {
            list-style-position: inside;
            padding-left: 0.5rem;
            margin-top: 0.75rem; /* Consistent spacing */
        }
         .info-box1 li {
            margin-bottom: 0.6rem; /* Slightly more space */
        }
        .info-box1 p + ul, .info-box1 ul + p,
        .info-box1 p + ol, .info-box1 ol + p {
            margin-top: 1rem;
        }
        .info-box1 strong {
            color: var(--text-main); /* Ensure strong text is readable */
        }


        /* --- Code Blocks (Prism.js) --- */
        .code-block {
          margin-top: 1.5rem; /* Increased margin */
          border-radius: 8px;
          overflow: hidden;
          box-shadow: var(--shadow-md); /* Use theme shadow */
          border: 1px solid var(--card-border);
        }

        /* Prism Toolbar adjustments */
        div.code-toolbar {
            position: relative; /* Needed for button positioning */
        }
        div.code-toolbar > .toolbar {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            opacity: 0; /* Hide initially */
            transition: opacity 0.3s ease-in-out;
        }
        div.code-toolbar:hover > .toolbar {
            opacity: 1; /* Show on hover */
        }
        div.code-toolbar > .toolbar .toolbar-item > button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.4rem 0.8rem;
            border-radius: 6px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: background-color 0.2s ease;
            box-shadow: var(--shadow-sm);
        }
        div.code-toolbar > .toolbar .toolbar-item > button:hover {
            background: var(--primary-light);
        }
         .dark-mode div.code-toolbar > .toolbar .toolbar-item > button {
             background: var(--primary-light);
             color: var(--bg-dark);
         }
         .dark-mode div.code-toolbar > .toolbar .toolbar-item > button:hover {
             background: var(--primary);
         }


        /* Override Prism's default pre styles slightly */
        pre[class*="language-"] {
          margin: 0 !important; /* Remove Prism's margin */
          padding: 1.5rem !important; /* Increase padding */
          overflow-x: auto;
          background: var(--code-bg) !important; /* Use theme variable */
          font-family: "Fira Code", monospace !important;
          line-height: 1.7; /* Improved line height */
          font-size: 0.95em; /* Slightly larger relative size */
          border-radius: 0 0 8px 8px; /* Ensure bottom radius */
          border: none !important; /* Remove Prism border */
          
        }

        code[class*="language-"] {
          font-family: "Fira Code", monospace !important;
        }


        /* --- Tags --- */
        .tags {
          display: flex;
          flex-wrap: wrap;
          gap: 0.75rem; /* Increased gap */
          margin-top: 1.5rem; /* Increased margin */
        }

        .tag {
          background-color: var(--tag-bg-default); /* Default background */
          color: var(--tag-text-default); /* Default text */
          padding: 0.45rem 1rem; /* Adjusted padding */
          border-radius: 50px;
          font-size: 0.9rem; /* Slightly larger */
          font-weight: 500;
          border: 1px solid transparent;
           transition: all 0.2s ease;
        }
        .tag:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-sm);
            filter: brightness(1.1);
        }

        /* Specific Tag Colors */
        .tag.security { background-color: var(--tag-bg-security); color: var(--tag-text-security); }
        .tag.advanced { background-color: var(--tag-bg-advanced); color: var(--tag-text-advanced); }
        .tag.encryption { background-color: var(--tag-bg-encryption); color: var(--tag-text-encryption); }
        .tag.quality { background-color: var(--tag-bg-quality); color: var(--tag-text-quality); }
        .tag.convenience { background-color: var(--tag-bg-convenience); color: var(--tag-text-convenience); }
        .tag.analysis { background-color: var(--tag-bg-analysis); color: var(--tag-text-analysis); }
        /* Add more specific tags as needed */
        .tag.key-management { background-color: var(--tag-bg-convenience); color: var(--tag-text-convenience); }
        .tag.steganography { background-color: var(--tag-bg-advanced); color: var(--tag-text-advanced); }
        .tag.quality-assurance { background-color: var(--tag-bg-quality); color: var(--tag-text-quality); }


        /* --- Footer --- */
        footer {
          margin-top: 6rem; /* Increased margin */
          text-align: center;
          padding: 3rem 2rem; /* Increased padding */
          color: var(--text-muted);
          opacity: 0.9;
          font-size: 0.95rem;
          border-top: 1px solid var(--card-border);
          background-color: var(--card-bg); /* Subtle background */
          transition: background-color 0.4s ease, border-color 0.4s ease;
        }
        .footer-content {
            max-width: 800px;
            margin: 0 auto;
        }
        .footer-links {
            margin-top: 1.5rem;
            display: flex;
            justify-content: center;
            gap: 1.8rem; /* Increased gap */
            flex-wrap: wrap;
        }
        .footer-links a {
            color: var(--primary);
            text-decoration: none;
            transition: color 0.3s ease;
            font-size: 1rem; /* Slightly larger */
            display: inline-flex; /* Align icon and text */
            align-items: center;
            gap: 0.5rem;
        }
        .footer-links a:hover {
            color: var(--primary-light);
            text-decoration: underline;
        }

        /* --- Metrics Grid --- */
        .metrics-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
          gap: 1.5rem;
          margin: 2rem 0;
        }

        .metric-card {
          background: var(--card-bg);
          padding: 1.5rem;
          border-radius: 0.75rem;
          box-shadow: var(--shadow-sm);
          border: 1px solid var(--card-border);
        }
        .metric-card:hover {
          transform: translateY(-5px);
          box-shadow: var(--shadow-lg);
        }
        .metric-value {
          font-size: 2.5rem; /* Larger */
          font-weight: 700;
          color: var(--primary);
          margin: 0.75rem 0;
        }
        .metric-title {
          font-size: 1.1rem; /* Larger title */
          color: var(--text-main);
          font-weight: 600; /* Make title bolder */
          margin-bottom: 0.5rem; /* Space below title */
        }
         .metric-card p { /* Style the description paragraph */
            font-size: 0.95rem; /* Slightly larger */
            color: var(--text-muted);
            line-height: 1.6;
        }


        /* --- Tooltips --- */
        .tooltip {
          position: relative;
          display: inline-block;
          cursor: help;
          border-bottom: 1px dashed var(--primary); /* Dashed indicator */
        }

        .tooltip .tooltip-text {
          visibility: hidden;
          width: 260px; /* Wider */
          background-color: var(--dark);
          color: var(--light);
          text-align: left; /* Left align text */
          border-radius: 8px; /* Smoother radius */
          padding: 1rem; /* Increased padding */
          position: absolute;
          z-index: 10;
          bottom: 140%; /* Position above */
          left: 50%;
          margin-left: -130px; /* Center */
          opacity: 0;
          transition: opacity 0.3s ease, transform 0.3s ease;
          font-size: 0.95rem; /* Larger tooltip text */
          box-shadow: var(--shadow-lg);
          transform: translateY(10px); /* Start slightly lower */
        }
        /* Arrow */
        .tooltip .tooltip-text::after {
            content: "";
            position: absolute;
            top: 100%; /* At the bottom of the tooltip */
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: var(--dark) transparent transparent transparent;
        }


        .dark-mode .tooltip .tooltip-text {
          background-color: var(--primary-light);
          color: var(--bg-dark); /* Use dark text on light bg */
        }
         .dark-mode .tooltip .tooltip-text::after {
             border-color: var(--primary-light) transparent transparent transparent;
         }

        .tooltip:hover .tooltip-text {
          visibility: visible;
          opacity: 1;
          transform: translateY(0); /* Move to final position */
        }

        /* --- Interactive Demos --- */
        .interactive-demo {
          margin: 3rem 0; /* Increased margin */
          border-radius: 16px;
          overflow: hidden;
          background: var(--card-bg);
          backdrop-filter: blur(10px);
          box-shadow: var(--shadow-lg); /* Use larger shadow */
          border: 1px solid var(--card-border);
          transition: all 0.4s ease;
        }
         /* Styles specific to demo containers */
         .demo-container, .comparison-container, .adaptive-channel-container {
            padding: 2.5rem;
            transition: background-color 0.4s ease;
         }
          .demo-container h3, .comparison-container h3, .adaptive-channel-container h3 {
            font-size: 1.8rem; /* Larger demo titles */
            font-weight: 600;
            margin-bottom: 1.8rem;
            color: var(--primary);
            text-align: center;
        }
         .comparison-description, .adaptive-channel-container .description, .demo-container .comparison-description {
            text-align: center;
            margin-bottom: 2rem;
            color: var(--text-muted);
            font-size: 1.05rem;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }
         .demo-controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 2.5rem;
        }
        .reset-button, .next-button, .demo-button {
            padding: 0.9rem 1.8rem; /* Larger buttons */
            font-size: 1rem; /* Larger button text */
            border-radius: 50px;
            border: 1px solid var(--primary);
            background-color: var(--primary);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        .reset-button {
            background-color: transparent;
            color: var(--primary);
        }
        .reset-button:hover {
            background-color: rgba(79, 70, 229, 0.1);
        }
         .next-button:disabled, .demo-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .next-button:not(:disabled):hover, .demo-button:not(:disabled):hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        /* Placeholder input styles */
        .demo-upload-area {
            margin: 1.5rem auto;
            padding: 1.5rem;
            border: 2px dashed var(--card-border);
            border-radius: 10px;
            text-align: center;
            max-width: 500px;
        }
        .demo-upload-area label {
            cursor: pointer;
            color: var(--primary);
            font-weight: 500;
        }
        .demo-upload-area input[type="file"] {
            display: none;
        }
        .demo-upload-area p {
            color: var(--text-muted);
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }


        /* --- FAQ Section --- */
        .faq-container {
          margin: 2.5rem 0;
        }

        .faq-item {
          margin-bottom: 1rem; /* Reduced gap */
          border-radius: 12px;
          overflow: hidden;
          background: transparent; /* Make transparent within section */
          border: none; /* Remove border */
          border-bottom: 1px solid var(--card-border); /* Use bottom border instead */
          transition: background-color 0.3s ease; /* Transition background on hover/active */
        }
         .faq-item:last-child {
             border-bottom: none;
         }

        .faq-question {
          padding: 1.5rem 1rem; /* Adjusted padding */
          display: flex;
          justify-content: space-between;
          align-items: center;
          cursor: pointer;
          transition: background-color 0.2s ease;
          border-radius: 12px 12px 0 0; /* Apply radius only if using background */
        }
        .faq-question:hover {
            background-color: rgba(79, 70, 229, 0.05);
        }
        .dark-mode .faq-question:hover {
            background-color: rgba(129, 140, 248, 0.08);
        }

        .faq-question h3 {
          font-size: 1.25rem; /* Slightly larger */
          font-weight: 600;
          margin: 0;
          flex-grow: 1;
          color: var(--text-main); /* Use main text color */
        }

        .faq-question i {
          color: var(--primary);
          transition: transform 0.3s ease;
          flex-shrink: 0;
          margin-left: 1.5rem; /* Increased spacing */
          font-size: 1rem; /* Slightly smaller icon */
        }

        .faq-answer {
          max-height: 0;
          overflow: hidden;
          transition: max-height 0.4s ease-out, padding 0.4s ease-out;
          padding: 0 1rem; /* Adjust horizontal padding */
          color: var(--text-muted); /* Muted color for answer */
           font-size: 1.05rem; /* Larger answer text */
           line-height: 1.7; /* Ensure good line height */
        }
        .faq-answer p, .faq-answer ul {
          margin: 0;
          padding-bottom: 1.5rem; /* Add padding only when open */
        }
        .faq-answer ul {
            list-style-position: outside;
            padding-left: 1.5rem;
            margin-top: 0.5rem;
        }
         .faq-answer li {
            margin-bottom: 0.6rem; /* More space */
        }


        .faq-item.active {
          /* Optional: Add background when active */
           /* background: rgba(79, 70, 229, 0.03); */
        }
        .dark-mode .faq-item.active {
            /* background: rgba(129, 140, 248, 0.05); */
        }

        .faq-item.active .faq-question i {
          transform: rotate(135deg);
        }

        .faq-item.active .faq-answer {
          max-height: 600px; /* Adjust as needed, ensure enough height */
          padding: 0 1rem;
        }


        /* --- Contributors Section --- */
        .contributors-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
          gap: 2rem;
          margin-top: 2.5rem;
        }
        .contributor-card {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            padding: 1.5rem;
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--card-border);
            transition: all 0.3s ease;
        }
        .contributor-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }
        .contributor-avatar {
            font-size: 3.5rem;
            color: var(--primary);
            flex-shrink: 0;
            background: var(--gradient);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }
        .contributor-info h3 {
            margin-bottom: 0.25rem;
            font-size: 1.2rem;
            color: var(--primary);
        }
        .contributor-info p {
            font-size: 0.95rem;
            opacity: 0.8;
            margin-bottom: 0.75rem;
            color: var(--text-muted);
        }
        .contributor-links a {
            color: var(--secondary);
            margin-right: 0.75rem;
            font-size: 1.2rem;
            transition: color 0.3s ease;
        }
        .contributor-links a:hover {
            color: var(--primary-light);
        }

        .acknowledgements {
            margin-top: 3rem;
            padding: 1.8rem; /* Increased padding */
            background: rgba(79, 70, 229, 0.05);
            border-radius: 8px;
            border-left: 4px solid var(--primary);
            font-size: 1rem; /* Increased font size */
             transition: background-color 0.4s ease, border-color 0.4s ease;
        }
         .dark-mode .acknowledgements {
             background: rgba(129, 140, 248, 0.08);
             color: var(--text-muted); /* Ensure text is readable */
             border-left-color: var(--primary);
         }
        .acknowledgements h3 {
            color: var(--primary);
            margin-bottom: 1rem; /* More space */
            font-size: 1.2rem; /* Larger heading */
        }
        .dark-mode .acknowledgements h3 { color: var(--primary); }
        .acknowledgements p { line-height: 1.7; }
        .acknowledgements a { color: var(--secondary); font-weight: 500; text-decoration: underline; }
        .acknowledgements a:hover { color: var(--primary-light); }


        /* --- Tables --- */
        .table-container {
            overflow-x: auto;
            margin: 2.5rem 0;
            border: 1px solid var(--card-border);
            border-radius: 10px;
            background-color: var(--card-bg);
            box-shadow: var(--shadow-md);
             transition: background-color 0.4s ease, border-color 0.4s ease;
        }

        .table-container table {
            width: 100%;
            border-collapse: collapse;
        }

        .table-container th,
        .table-container td {
            border: none; /* Remove internal borders */
            border-bottom: 1px solid var(--card-border); /* Use bottom borders */
            padding: 1.1rem 1.3rem; /* Increased padding */
            text-align: left;
            font-size: 1rem; /* Larger table text */
            vertical-align: middle; /* Vertically align content */
            white-space: normal; /* Allow wrapping */
        }
         .table-container tr:last-child td {
             border-bottom: none; /* No border on last row */
         }

        .table-container th {
            background-color: rgba(79, 70, 229, 0.05); /* Lighter header */
            font-weight: 600;
            color: var(--primary);
            font-size: 1.05rem; /* Slightly larger header */
            white-space: nowrap; /* Prevent header wrapping */
        }
        .dark-mode .table-container th {
            background-color: rgba(129, 140, 248, 0.1);
            color: var(--primary);
        }

        .table-container tbody tr:nth-child(even) {
            background-color: rgba(0, 0, 0, 0.015); /* Subtle striping */
        }
        .dark-mode .table-container tbody tr:nth-child(even) {
            background-color: rgba(255, 255, 255, 0.02);
        }
         .table-container tbody tr:hover {
             background-color: rgba(79, 70, 229, 0.03);
         }
          .dark-mode .table-container tbody tr:hover {
             background-color: rgba(129, 140, 248, 0.05);
         }

        /* Center comparison columns, but allow first col to be left */
         .table-container td:not(:first-child) {
             text-align: center;
         }
          .table-container td:first-child {
             text-align: left;
             font-weight: 500; /* Slightly bolder first column */
         }

        .table-container td strong {
            color: var(--text-main); /* Ensure strong text is readable */
            font-weight: 600;
        }
        .table-container td strong[style*="color: var(--error)"] { color: var(--error); } /* Make error color work */


        /* --- Back to Top Button --- */
        .back-to-top {
          position: fixed;
          bottom: 30px;
          right: 30px;
          width: 50px; /* Adjusted size */
          height: 50px;
          border-radius: 50%;
          background: var(--primary);
          color: white;
          display: flex;
          justify-content: center;
          align-items: center;
          cursor: pointer;
          transition: all 0.4s ease;
          transform: translateY(100px) scale(0.8); /* Start lower and smaller */
          opacity: 0;
          border: none;
          box-shadow: var(--shadow-lg);
          z-index: 100;
          font-size: 1.2rem;
        }

        .back-to-top.show {
          transform: translateY(0) scale(1);
          opacity: 1;
        }

        .back-to-top:hover {
          background: var(--primary-light);
          transform: translateY(-5px) scale(1.05);
        }

        /* --- Animations --- */
        @keyframes pulse {
          0% { transform: scale(1); opacity: 1; }
          50% { transform: scale(1.08); opacity: 0.85; }
          100% { transform: scale(1); opacity: 1; }
        }

        @keyframes fadeIn {
          from { opacity: 0; transform: translateY(30px); }
          to { opacity: 1; transform: translateY(0); }
        }

        /* --- Responsive Design --- */
        @media (max-width: 1200px) { /* Hide ToC sidebar */
            #toc {
                position: fixed; /* Change to fixed for mobile overlay */
                left: 0;
                top: 0; /* Align to top */
                width: 300px; /* Width when shown */
                height: 100vh; /* Full height */
                background-color: var(--card-bg); /* Use card bg */
                backdrop-filter: blur(10px);
                z-index: 200; /* Above everything else */
                transform: translateX(-100%); /* Hide off-screen */
                transition: transform 0.4s ease;
                border-right: 1px solid var(--card-border);
                padding: 6rem 1.5rem 2rem 1.5rem; /* Adjust padding */
                overflow-y: auto; /* Ensure scrolling */
            }
            #toc.show-mobile {
                transform: translateX(0); /* Slide in */
                box-shadow: var(--shadow-xl);
            }
            .toc-toggle-mobile {
                display: flex; /* Show button */
                align-items: center;
                justify-content: center;
            }
             .main-content {
                padding: 0 1.5rem; /* Adjust padding */
            }
        }

         @media (max-width: 768px) {
          body {
            font-size: 17px; /* Adjust base font size */
            line-height: 1.65; /* Adjust line height */
          }
           .main-content {
                padding: 0 1rem; /* Smaller padding on mobile */
            }
          header {
            padding: 1rem;
            flex-wrap: wrap; /* Allow wrapping */
            gap: 1rem;
          }
          .logo h1 { font-size: 1.5rem; }
          .logo-icon { font-size: 1.8rem; }

          .header-buttons {
            gap: 0.5rem;
            flex-grow: 1; /* Allow buttons to take space if needed */
            justify-content: flex-end;
          }
           .search-container { display: none; } /* Hide search on small screens */
           .theme-toggle, .return-button { padding: 0.5rem 0.8rem; font-size: 0.85rem; }

          #hero h1 { font-size: 2.8rem; } /* Slightly larger on mobile */
          #hero .tagline { font-size: 1.15rem; }

          .section {
            padding: 2rem 1.5rem; /* Adjust padding */
            margin-bottom: 3rem;
          }
          .section-header h2 { font-size: 1.9rem; } /* Adjust heading */
          .section-header i { width: 45px; height: 45px; font-size: 1.5rem;}

          .process-step {
            flex-direction: column;
            padding: 1.5rem;
            gap: 1rem;
          }
          .step-number {
            margin-bottom: 1rem;
            align-self: flex-start;
          }
           .feature-grid { grid-template-columns: 1fr; gap: 1.5rem; } /* Stack cards */
           .metrics-grid { grid-template-columns: 1fr; gap: 1.5rem; } /* Stack metrics */

           .flowchart-tabs { gap: 0.3rem; } /* Slightly more gap */
           .flowchart-tab { padding: 0.7rem 1.1rem; font-size: 0.95rem;} /* Larger tab text */

            /* Demo layout on mobile */
           .lsb-demo .demo-content { flex-direction: column; }
           .adaptive-channel-container .adaptive-content { flex-direction: column; gap: 2rem; }
           .metrics-display { flex-direction: column; gap: 1rem; }
        }

        /* --- Print Styles --- */
        @media print {
          .back-to-top,
          .theme-toggle,
          .return-button,
          .header-buttons .search-container, /* Hide search */
          .toc-toggle-mobile, /* Hide ToC toggle */
          #toc, /* Hide ToC sidebar */
          header, /* Hide sticky header */
          #hero, /* Hide hero section */
          footer, /* Hide footer */
          .interactive-demo, /* Hide complex demos */
          div.code-toolbar > .toolbar /* Hide copy button */
          {
            display: none !important;
          }

          body {
            background: white !important;
            color: black !important;
            font-size: 11pt !important; /* Adjust print font size */
            line-height: 1.4 !important;
          }
          .page-wrapper, .content-wrapper, .main-content {
              display: block !important; /* Reset flex */
              padding: 0 !important;
              max-width: 100% !important;
              margin: 0 !important;
          }

          :root { /* Reset vars for print */
              --primary: #000000;
              --primary-light: #333333;
              --secondary: #555555;
              --dark: #000000;
              --light: #ffffff;
              --card-bg: #ffffff;
              --card-border: #cccccc;
              --bg-main: #ffffff;
              --text-main: #000000;
              --text-muted: #444444;
              --code-bg: #eeeeee;
          }

           .logo { display: none; } /* Hide logo */

          .section {
            opacity: 1 !important;
            transform: none !important;
            page-break-inside: avoid;
            box-shadow: none !important;
            border: 1px solid #ccc !important;
            background: white !important;
            margin-bottom: 1.5rem !important;
            padding: 1.5cm !important; /* Add print margins */
            border-radius: 0 !important;
          }
           .section-header h2 { color: black !important; }
           .section-header i { display: none !important; } /* Hide icons */
            .step-number { background: black !important; color: white !important; }
            

          .chart svg { max-height: 8cm !important; width: auto !important; } /* Allow larger charts */
          .code-block { box-shadow: none !important; border: 1px solid #ccc; }
          pre[class*="language-"] { background: #eee !important; color: #333 !important; border-radius: 0 !important; padding: 1em !important; font-size: 9pt !important; }
          .tag { border: 1px solid #ccc; background: none !important; color: black !important; padding: 0.2em 0.5em; }
          a { text-decoration: none; color: black; }
           a[href^="http"]:after { content: " (" attr(href) ")"; font-size: 90%; } /* Show external links */
          .info-box { background: #f0f0f0 !important; border-left-color: #999 !important; }
          .table-container { box-shadow: none !important; border: 1px solid #ccc; page-break-inside: avoid; }
          .table-container th, .table-container td { border: 1px solid #ccc !important; font-size: 9pt !important; }
          .faq-item { border-bottom: 1px solid #ccc !important; page-break-inside: avoid; }
           .flowchart-tabs { display: none; } /* Hide tabs, show all content */
           .flowchart-content { display: block !important; opacity: 1 !important; transform: none !important; }
        }

        /* --- LSB Demo Styles --- */
        .lsb-demo .demo-content { display: flex; gap: 2rem; flex-wrap: wrap; justify-content: center; }
        .lsb-demo .original-pixels, .lsb-demo .modified-pixels { flex: 1; min-width: 300px; }
        .lsb-demo .channels { display: flex; flex-direction: column; gap: 1.5rem; }
        .lsb-demo .channel { background: rgba(0,0,0,0.02); padding: 1rem; border-radius: 8px; }
        .dark-mode .lsb-demo .channel { background: rgba(255,255,255,0.03); }
        .lsb-demo .channel-label { display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem; font-weight: 500; }
        .lsb-demo .color-box { width: 20px; height: 20px; border-radius: 4px; border: 1px solid rgba(0,0,0,0.1); }
        .lsb-demo .bits { display: flex; gap: 3px; flex-wrap: wrap; }
        .lsb-demo .bit {
            width: 32px; height: 32px; /* Larger bits */
            display: flex; justify-content: center; align-items: center;
            border: 1px solid #ccc; border-radius: 4px;
            font-family: monospace; font-size: 1rem; /* Larger bit font */
            background-color: var(--bg-main);
            transition: all 0.2s ease;
        }
        .lsb-demo .bit.lsb { border-color: var(--primary); font-weight: bold; }
        .lsb-demo .bit.lsb.highlight { background-color: hsla(50, 100%, 80%, 0.5); border-color: var(--accent); transform: scale(1.05); }
        .lsb-demo .bit.lsb.modified { background-color: hsla(120, 70%, 85%, 0.5); border-color: var(--success); } /* Green tint */
        .dark-mode .lsb-demo .bit { border-color: #555; }
        .dark-mode .lsb-demo .bit.lsb { border-color: var(--primary-light); }

        .lsb-demo .lsb-label {
            font-size: 0.9em; color: var(--text-muted); margin-left: 0.5em;
            font-style: italic; transition: opacity 0.3s ease;
        }
         .lsb-demo .secret-data { text-align: center; }
         .lsb-demo .secret-bits { display: flex; gap: 0.5rem; margin-top: 0.5rem; justify-content: center; }
         .lsb-demo .secret-bits .bit { border-width: 2px; }
         .lsb-demo .explanation-box {
            background-color: rgba(79, 70, 229, 0.03);
            padding: 1.5rem; border-radius: 8px;
            border: 1px dashed var(--card-border);
            font-size: 1rem;
         }
         .dark-mode .lsb-demo .explanation-box { background-color: rgba(129, 140, 248, 0.05); }


        /* --- Image Comparison Slider Styles --- */
        .comparison-container .slider-container {
            position: relative;
            width: 100%;
            max-width: 800px; /* Limit max width */
            aspect-ratio: 4 / 3; /* Maintain aspect ratio */
            overflow: hidden;
            margin: 2rem auto 0 auto; /* Center and add margin */
            border-radius: 10px;
            box-shadow: var(--shadow-lg);
            cursor: ew-resize;
        }
        .comparison-container .original-image,
        .comparison-container .stego-image {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            overflow: hidden; /* Critical */
        }
         .comparison-container .original-image img,
         .comparison-container .stego-image img {
            display: block; width: 100%; height: 100%; object-fit: cover;
        }
        .comparison-container .stego-image {
            clip-path: inset(0 50% 0 0); /* Default clip */
        }
        .comparison-container .slider-divider {
            position: absolute;
            top: 0; bottom: 0; width: 4px;
            background-color: rgba(255, 255, 255, 0.8);
            transform: translateX(-2px); /* Center line */
            z-index: 10;
            pointer-events: none; /* Let handle capture events */
            box-shadow: 0 0 10px rgba(0,0,0,0.5);
        }
        .comparison-container .slider-handle {
            position: absolute;
            top: 50%; left: 50%; /* Center handle on divider */
            transform: translate(-50%, -50%);
            width: 40px; height: 40px;
            border-radius: 50%;
            background-color: var(--primary);
            border: 3px solid white;
            display: flex; justify-content: center; align-items: center;
            color: white;
            cursor: ew-resize;
            z-index: 11; /* Above divider */
            pointer-events: auto; /* Allow dragging this */
            box-shadow: var(--shadow-md);
        }
        .comparison-container .slider-arrows { font-size: 0.8rem; }
        .comparison-container .slider-arrows i:first-child { margin-right: -2px; }
        .comparison-container .slider-arrows i:last-child { margin-left: -2px; }

         .comparison-container .image-label {
            position: absolute;
            bottom: 10px;
            background-color: rgba(0, 0, 0, 0.6);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.85rem;
            z-index: 5;
         }
         .comparison-container .original-label { left: 10px; }
         .comparison-container .stego-label { right: 10px; }

         /* Metrics Display below slider */
         .comparison-container .metrics-display {
            display: flex;
            justify-content: center;
            gap: 3rem;
            margin-top: 2.5rem;
            text-align: center;
         }
         .comparison-container .metric h4 {
            font-size: 1.1rem;
            color: var(--text-muted);
            margin-bottom: 0.5rem;
         }
         .comparison-container .metric .metric-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.5rem;
         }
         .comparison-container .metric .metric-description {
            font-size: 0.9rem;
            color: var(--text-muted);
         }

        /* --- Adaptive Channel Visualization Styles --- */
        .adaptive-channel-container .adaptive-content {
            display: flex;
            gap: 3rem;
            margin-top: 2rem;
            align-items: stretch; /* Make columns equal height */
        }
        .adaptive-channel-container .intensity-section,
        .adaptive-channel-container .channels-section {
            flex: 1;
            background: rgba(0,0,0,0.02);
            padding: 2rem;
            border-radius: 12px;
            transition: background-color 0.4s ease;
        }
        .dark-mode .adaptive-channel-container .intensity-section,
        .dark-mode .adaptive-channel-container .channels-section {
            background: rgba(255,255,255,0.03);
        }

        .adaptive-channel-container h4 {
            font-size: 1.3rem;
            margin-bottom: 1.5rem;
            color: var(--text-main);
        }

        .adaptive-channel-container .intensity-slider { margin-bottom: 2rem; }
        .adaptive-channel-container input[type="range"] { width: 100%; cursor: pointer; }
        .adaptive-channel-container .range-labels { display: flex; justify-content: space-between; font-size: 0.9em; color: var(--text-muted); margin-top: 0.5rem; }

        .adaptive-channel-container .intensity-display {
            width: 100%;
            height: 120px;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            transition: background-color 0.3s ease;
            border: 1px solid var(--card-border);
        }
        .adaptive-channel-container .intensity-value { font-size: 2rem; font-weight: bold; }
        .adaptive-channel-container .intensity-label { font-size: 0.9rem; margin-top: 0.5rem; font-weight: 500; }

        .adaptive-channel-container .channels-section p { margin-bottom: 1.5rem; font-size: 1.05rem; }
        .adaptive-channel-container .channel-list { display: flex; flex-direction: column; gap: 1rem; }
        .adaptive-channel-container .channel-item {
            display: flex; align-items: center; gap: 1rem;
            padding: 1rem; border-radius: 8px;
            background-color: var(--bg-main);
            transition: all 0.3s ease;
            border: 1px solid var(--card-border);
            opacity: 0.6;
        }
        .adaptive-channel-container .channel-item.active {
            opacity: 1;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(79, 70, 229, 0.2);
            background-color: rgba(79, 70, 229, 0.05);
        }
         .dark-mode .adaptive-channel-container .channel-item.active {
            background-color: rgba(129, 140, 248, 0.1);
            box-shadow: 0 0 0 2px rgba(129, 140, 248, 0.3);
            border-color: var(--primary);
         }

        .adaptive-channel-container .channel-color {
            width: 25px; height: 25px; border-radius: 50%; flex-shrink: 0;
            border: 1px solid rgba(0,0,0,0.1);
        }
        .adaptive-channel-container .channel-color.red { background-color: #ef4444; }
        .adaptive-channel-container .channel-color.green { background-color: #22c55e; }
        .adaptive-channel-container .channel-color.blue { background-color: #3b82f6; }
        .adaptive-channel-container .channel-name strong { color: var(--success); }


        .adaptive-channel-container .explanation-box {
            background-color: rgba(79, 70, 229, 0.03);
            padding: 1.5rem; border-radius: 8px;
            border: 1px dashed var(--card-border);
            font-size: 1rem;
            margin-top: 2.5rem; /* Space above explanation */
         }
         .dark-mode .adaptive-channel-container .explanation-box { background-color: rgba(129, 140, 248, 0.05); }
         .adaptive-channel-container .explanation-box h4 { margin-bottom: 1rem; }
         .adaptive-channel-container .explanation-items { display: flex; flex-direction: column; gap: 1rem; }
         .adaptive-channel-container .explanation-item { display: flex; align-items: center; gap: 1rem; }
         .adaptive-channel-container .dot { width: 15px; height: 15px; border-radius: 50%; flex-shrink: 0; }
         .adaptive-channel-container .dot.dark { background-color: #333; }
         .adaptive-channel-container .dot.medium { background-color: #888; }
         .adaptive-channel-container .dot.bright { background-color: #ddd; }

  </style>

</head>
<body>
  <div class="bg-pattern"></div>

  <div class="page-wrapper">
    <!-- Header section -->
    <header>
      <div class="logo">
        <i class="fas fa-shield-alt logo-icon"></i>
        <h1>Secure Steganography</h1> <!-- Shortened Title -->
      </div>
      <div class="header-buttons">
        <div class="search-container">
           <i class="fas fa-search"></i>
           <input type="search" id="searchInput" class="search-input" placeholder="Search documentation...">
        </div>
         <a href="index.html" class="return-button" title="Return to Application">
            <i class="fas fa-arrow-left"></i>
            <span class="sr-only">Return to App</span> <!-- Screen reader text -->
         </a>
        <button class="theme-toggle" id="themeToggle" title="Toggle Theme">
          <i class="fas fa-moon"></i>
          <span class="sr-only">Toggle Theme</span> <!-- Screen reader text -->
        </button>
         <button class="toc-toggle-mobile" id="tocToggleMobile" aria-label="Toggle Table of Contents">
             <i class="fas fa-bars"></i>
         </button>
      </div>
    </header>

    <!-- Hero Section -->
     <section id="hero">
        <div id="hero-content">
            <h1>Mastering Digital Concealment</h1>
            <p class="tagline">Explore the art and science of hiding messages within images using advanced steganography and robust AES-256 encryption.</p>
            <div class="hero-buttons">
                <a href="#overview" class="hero-button primary">Get Started</a>
                <a href="index.html" class="hero-button secondary">Try the App</a>
            </div>
        </div>
    </section>

    <div class="content-wrapper">
        <!-- Sticky Table of Contents -->
        <nav id="toc" aria-labelledby="toc-heading">
            <h3 id="toc-heading">Table of Contents</h3>
             <div id="toc-search-results" aria-live="polite">
                <!-- Search results will be injected here by JS -->
             </div>
            <ul id="toc-list">
                <!-- ToC links will be injected here by JS -->
            </ul>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content">
          <div class="container"> <!-- Inner container for content -->

            <!-- 1. Overview Section -->
            <section id="overview" class="section visible"> <!-- Start visible -->
              <div class="section-header">
                <i class="fas fa-info-circle"></i>
                <h2 data-toc="Project Overview">Project Overview</h2>
              </div>
              <p>This project implements an advanced steganography system that hides encrypted messages within images. Steganography is the practice of concealing a message within another medium, such as an image, without altering the appearance of the medium in a way that would raise suspicion.</p>
              <p>Combining robust AES-256 encryption with sophisticated LSB (Least Significant Bit) modification techniques, this tool provides a secure method for covert communication and data embedding.</p>

              <div class="feature-grid">
                 <div class="feature-card topic-security">
                  <h3><i class="fas fa-lock"></i> AES-256 Encryption</h3>
                  <p>Messages are secured using the industry-standard AES-256 algorithm in CBC mode before embedding, adding a critical layer of confidentiality.</p>
                  <div class="tags">
                    <span class="tag security">Security</span>
                    <span class="tag encryption">Encryption</span>
                  </div>
                </div>

                <div class="feature-card topic-stegano">
                  <h3><i class="fas fa-palette"></i> Adaptive LSB</h3>
                  <p>Employs intensity-based channel selection for LSB modification, minimizing visual distortion and enhancing resistance to basic steganalysis.</p>
                  <div class="tags">
                    <span class="tag advanced">Advanced</span>
                    <span class="tag steganography">Steganography</span>
                  </div>
                </div>

                <div class="feature-card topic-key">
                  <h3><i class="fas fa-key"></i> Embedded Key Option</h3>
                  <p>Optionally embed the encryption key (itself encrypted) within the image, simplifying secure key distribution for the intended recipient.</p>
                  <div class="tags">
                    <span class="tag key-management">Key Management</span>
                    <span class="tag convenience">Convenience</span>
                  </div>
                </div>
                <div class="feature-card">
                  <h3><i class="fas fa-check-circle"></i> Error Correction</h3>
                  <p>Implements error correction to improve message recovery even if the stego image is slightly distorted.</p>
                  <div class="tags">
                    <span class="tag advanced">Advanced</span>
                    <span class="tag">Reliability</span>
                  </div>
                </div>

                <div class="feature-card topic-quality">
                  <h3><i class="fas fa-chart-bar"></i> Quality Metrics</h3>
                  <p>Provides PSNR and SSIM metrics to evaluate the visual impact of the hidden data, ensuring high imperceptibility.</p>
                  <div class="tags">
                    <span class="tag analysis">Analysis</span>
                    <span class="tag quality-assurance">Quality Assurance</span>
                  </div>
                </div>
              </div>
            </section>

            <!-- 2. Architecture Section -->
            <section id="architecture" class="section">
              <div class="section-header">
                <i class="fas fa-sitemap"></i>
                <h2 data-toc="System Architecture">System Architecture</h2>
              </div>
              <p>The steganography application follows a modular architecture, separating concerns between the user interface, the API layer, and the core processing engine.</p>

              <div class="process-step">
                <div class="step-number">1</div>
                <div class="step-content">
                  <h3>Front-End Web Interface (index.html)</h3>
                  <p>A modern, responsive user interface built with HTML, CSS, and JavaScript. It allows users to interact with the steganography functions, manage files, and view results.</p>
                  <div class="info-box">
                    <p><strong>Technologies:</strong> HTML5, CSS3 (with Custom Properties), Vanilla JavaScript, Font Awesome icons. React is used for specific interactive demo components.</p>
                    <p><strong>Functionality:</strong> File uploads, message input, key generation/input, option selection, result display, communication with the backend API.</p>
                  </div>
                </div>
              </div>

              <div class="process-step">
                <div class="step-number">2</div>
                <div class="step-content">
                  <h3>API Layer (app12.py)</h3>
                  <p>A backend server built with Flask (Python) that exposes RESTful API endpoints to handle requests from the front-end.</p>
                   <div class="info-box">
                     <p><strong>Technology:</strong> Python, Flask Web Framework.</p>
                    <p><strong>Responsibilities:</strong> Handles HTTP requests, manages file uploads and temporary storage, validates input, orchestrates calls to the core steganography module, formats and returns responses (JSON).</p>
                  </div>
                </div>
              </div>

              <div class="process-step" style="border-bottom: none;"> 
                <div class="step-number">3</div>
                <div class="step-content">
                  <h3>Core Steganography Module (stegfile.py)</h3>
                  <p>A Python module containing the core logic for all steganographic and cryptographic operations.</p>
                  <div class="info-box">
                     <p><strong>Technologies:</strong> Python, NumPy (for array manipulation), Pillow (PIL fork for image I/O), PyCryptodome (for AES encryption), scikit-image (for quality metrics).</p>
                     <p><strong>Functions:</strong> Key generation, AES encryption/decryption, message-to-binary conversion, LSB embedding (Simple & Enhanced), data extraction, header management, key embedding/extraction, metrics calculation.</p>
                  </div>
                </div>
              </div>

               <div class="flowchart-container">
                 <h3>System Interaction Flow</h3>
                 <div class="chart">
                   
                    <svg viewBox="0 0 1100 600" width="100%" height="auto" xmlns="http://www.w3.org/2000/svg">
                        <rect width="1100" height="600" fill="var(--bg-main)" rx="10" ry="10" />

                        
                        <rect x="50" y="50" width="250" height="150" rx="15" ry="15" fill="#e0e7ff" stroke="#4f46e5" stroke-width="2" />
                        <text x="175" y="95" font-family="Arial, sans-serif" font-size="18" text-anchor="middle" font-weight="bold">Web Interface</text>
                        <text x="175" y="130" font-family="Arial, sans-serif" font-size="15" text-anchor="middle">index.html</text>
                        <text x="175" y="155" font-family="Arial, sans-serif" font-size="13" text-anchor="middle">HTML, CSS, JS, React</text>

                        <rect x="425" y="50" width="250" height="150" rx="15" ry="15" fill="#e0f2fe" stroke="#0284c7" stroke-width="2" />
                        <text x="550" y="95" font-family="Arial, sans-serif" font-size="18" text-anchor="middle" font-weight="bold">API Server</text>
                        <text x="550" y="130" font-family="Arial, sans-serif" font-size="15" text-anchor="middle">app12.py</text>
                        <text x="550" y="155" font-family="Arial, sans-serif" font-size="13" text-anchor="middle">Flask, REST API</text>

                        <rect x="800" y="50" width="250" height="150" rx="15" ry="15" fill="#ecfdf5" stroke="#059669" stroke-width="2" />
                        <text x="925" y="95" font-family="Arial, sans-serif" font-size="18" text-anchor="middle" font-weight="bold">Steganography Module</text>
                        <text x="925" y="130" font-family="Arial, sans-serif" font-size="15" text-anchor="middle">stegfile.py</text>
                        <text x="925" y="155" font-family="Arial, sans-serif" font-size="13" text-anchor="middle">NumPy, Pillow, Crypto</text>

                        <rect x="425" y="300" width="250" height="150" rx="15" ry="15" fill="#f3e8ff" stroke="#a855f7" stroke-width="2" />
                        <text x="550" y="345" font-family="Arial, sans-serif" font-size="18" text-anchor="middle" font-weight="bold">File System</text>
                        <text x="550" y="380" font-family="Arial, sans-serif" font-size="15" text-anchor="middle">Images, Keys, Output</text>
                        <text x="550" y="405" font-family="Arial, sans-serif" font-size="13" text-anchor="middle">Server Storage</text>

                        
                        <line x1="300" y1="125" x2="425" y2="125" stroke="var(--text-muted)" stroke-width="2.5" marker-end="url(#arrow)" />
                        <text x="362.5" y="115" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">API Calls (Fetch)</text>
                        <line x1="425" y1="105" x2="300" y2="105" stroke="var(--text-muted)" stroke-width="2.5" marker-end="url(#arrow)" />
                        <text x="362.5" y="95" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">JSON Responses</text>

                        <line x1="675" y1="125" x2="800" y2="125" stroke="var(--text-muted)" stroke-width="2.5" marker-end="url(#arrow)" />
                        <text x="737.5" y="115" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Function Calls</text>
                        <line x1="800" y1="105" x2="675" y2="105" stroke="var(--text-muted)" stroke-width="2.5" marker-end="url(#arrow)" />
                        <text x="737.5" y="95" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Return Values</text>

                        <line x1="550" y1="200" x2="550" y2="300" stroke="var(--text-muted)" stroke-width="2.5" marker-end="url(#arrow)" />
                        <text x="570" y="250" font-family="Arial, sans-serif" font-size="14" text-anchor="start">Read/Write</text>
                        <text x="570" y="270" font-family="Arial, sans-serif" font-size="14" text-anchor="start">Files</text>

                        
                        <rect x="50" y="300" width="300" height="220" rx="10" ry="10" fill="var(--card-bg)" stroke="var(--card-border)" stroke-width="1" />
                        <text x="200" y="325" font-family="Arial, sans-serif" font-size="17" text-anchor="middle" font-weight="bold">Key Frontend Features</text>
                        <line x1="75" y1="340" x2="325" y2="340" stroke="var(--card-border)" stroke-width="1" />
                        <text x="85" y="365" font-family="Arial, sans-serif" font-size="14" text-anchor="start"> Image Upload/Preview</text>
                        <text x="85" y="390" font-family="Arial, sans-serif" font-size="14" text-anchor="start"> Key Management (Gen/Input)</text>
                        <text x="85" y="415" font-family="Arial, sans-serif" font-size="14" text-anchor="start"> Message Input/Output</text>
                        <text x="85" y="440" font-family="Arial, sans-serif" font-size="14" text-anchor="start"> Metrics Display (PSNR/SSIM)</text>
                        <text x="85" y="465" font-family="Arial, sans-serif" font-size="14" text-anchor="start"> Advanced Settings Controls</text>
                        <text x="85" y="490" font-family="Arial, sans-serif" font-size="14" text-anchor="start"> Interactive Demos (React)</text>

                        <rect x="750" y="300" width="300" height="220" rx="10" ry="10" fill="var(--card-bg)" stroke="var(--card-border)" stroke-width="1" />
                        <text x="900" y="325" font-family="Arial, sans-serif" font-size="17" text-anchor="middle" font-weight="bold">Key Algorithm Features</text>
                        <line x1="775" y1="340" x2="1025" y2="340" stroke="var(--card-border)" stroke-width="1" />
                        <text x="785" y="365" font-family="Arial, sans-serif" font-size="14" text-anchor="start"> AES-256 Encryption (CBC)</text>
                        <text x="785" y="390" font-family="Arial, sans-serif" font-size="14" text-anchor="start"> RGB Intensity-based LSB</text>
                        <text x="785" y="415" font-family="Arial, sans-serif" font-size="14" text-anchor="start"> Simple LSB Option</text>
                        <text x="785" y="440" font-family="Arial, sans-serif" font-size="14" text-anchor="start"> Data Header (Length/Marker)</text>
                        <text x="785" y="465" font-family="Arial, sans-serif" font-size="14" text-anchor="start"> Key Embedding (Optional)</text>
                        <text x="785" y="490" font-family="Arial, sans-serif" font-size="14" text-anchor="start"> PSNR/SSIM Calculation</text>

                        <defs>
                          <marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
                            <path d="M 0 0 L 10 5 L 0 10 z" fill="var(--text-muted)" />
                          </marker>
                        </defs>
                   </svg>
                  
                 </div>
               </div>
            </section>

            <!-- 3. Key Management Section -->
            <section id="key-management" class="section">
              <div class="section-header">
                <i class="fas fa-key"></i>
                <h2 data-toc="Key Management">Key Management</h2>
              </div>
              <p>Effective key management is paramount for secure communication. This system utilizes <span class="tooltip">AES-256<span class="tooltip-text">Advanced Encryption Standard with a 256-bit key, a widely trusted symmetric encryption algorithm.</span></span> keys and offers flexible handling options.</p>

               <div class="tabbed-section-container"> 
                  <div class="flowchart-tabs">
                    <div class="flowchart-tab active" data-target="key-generation">Generation</div>
                    <div class="flowchart-tab" data-target="key-embedding">Embedding</div>
                    <div class="flowchart-tab" data-target="key-extraction">Extraction</div>
                    <div class="flowchart-tab" data-target="key-security">Security</div>
                  </div>

                  <div class="flowchart-content active" id="key-generation">
                     <div class="process-step">
                       <div class="step-number">G</div> 
                       <div class="step-content">
                         <h3>Key Generation</h3>
                         <p>New, cryptographically secure 256-bit (32-byte) keys are generated using Python's `secrets` module, ensuring high entropy and unpredictability.</p>
                         <div class="chart">
                          <svg viewBox="0 0 800 300" width="100%" height="auto" xmlns="http://www.w3.org/2000/svg">
                           <!-- Background -->
                           <rect width="800" height="300" fill="#ffffff" rx="10" ry="10"></rect>
               
                           <!-- Start node -->
                           <circle cx="100" cy="150" r="30" fill="#4f46e5"></circle>
                           <text x="100" y="155" font-family="Arial" font-size="14" text-anchor="middle" fill="white">Start</text>
               
                           <!-- Generate Key -->
                           <rect x="200" y="120" width="160" height="60" rx="10" ry="10" fill="#e0e7ff" stroke="#4f46e5" stroke-width="2"></rect>
                           <text x="280" y="155" font-family="Arial" font-size="14" text-anchor="middle">Generate 256-bit Key</text>
               
                           <!-- Convert to Hex -->
                           <rect x="430" y="120" width="160" height="60" rx="10" ry="10" fill="#e0e7ff" stroke="#4f46e5" stroke-width="2"></rect>
                           <text x="510" y="155" font-family="Arial" font-size="14" text-anchor="middle">Convert to Hex String</text>
               
                           <!-- End node -->
                           <circle cx="700" cy="150" r="30" fill="#059669"></circle>
                           <text x="700" y="155" font-family="Arial" font-size="14" text-anchor="middle" fill="white">End</text>
               
                           <!-- Arrows -->
                           <line x1="130" y1="150" x2="200" y2="150" stroke="#6b7280" stroke-width="2" marker-end="url(#arrow)"></line>
                           <line x1="360" y1="150" x2="430" y2="150" stroke="#6b7280" stroke-width="2" marker-end="url(#arrow)"></line>
                           <line x1="590" y1="150" x2="670" y2="150" stroke="#6b7280" stroke-width="2" marker-end="url(#arrow)"></line>
               
                           <!-- Code box -->
                           <rect x="150" y="220" width="500" height="70" rx="5" ry="5" fill="#f1f5f9" stroke="#ccc" stroke-width="1"></rect>
                           <text x="160" y="240" font-family="'Courier New', monospace" font-size="12" text-anchor="start" fill="#333">def generate_key():</text>
                           <text x="180" y="255" font-family="'Courier New', monospace" font-size="12" text-anchor="start" fill="#333">key_bytes = secrets.token_bytes(32)</text>
                           <text x="180" y="270" font-family="'Courier New', monospace" font-size="12" text-anchor="start" fill="#333">return binascii.hexlify(key_bytes).decode('ascii')</text>
                           <defs>
                             <marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
                               <path d="M 0 0 L 10 5 L 0 10 z" fill="#6b7280"></path>
                             </marker>
                           </defs>
                         </svg>
                       </div>
                         <div class="info-box">
                           <p>The raw key bytes are converted into a 64-character hexadecimal string for easy display, input, and handling within the application interface.</p>
                         </div>
                          <div class="code-block">
                            <pre><code class="language-python">
import secrets
import binascii

def generate_aes256_key_hex():
    """Generates a secure 256-bit key and returns its hex representation."""
    key_bytes = secrets.token_bytes(32) # 32 bytes = 256 bits
    hex_key = binascii.hexlify(key_bytes).decode('ascii')
    return hex_key

# Example usage:
# new_key = generate_aes256_key_hex()
# print(f"Generated Key: {new_key}")
                            </code></pre>
                          </div>
                       </div>
                     </div>
                  </div>

                  <div class="flowchart-content" id="key-embedding">
                     <div class="process-step" style="border-bottom: none;"> 
                       <div class="step-number">E</div>
                       <div class="step-content">
                         <h3>Optional Key Embedding</h3>
                         <p>Users can choose to embed the AES encryption key directly into the stego-image. This facilitates sharing as the recipient doesn't need the key separately, but relies on the embedded key's security.</p>
                         <div class="flowchart-container" style="margin-top: 1.5rem;">
                         
                          <div class="chart">
                            <svg viewBox="0 0 800 400" width="100%" height="auto" xmlns="http://www.w3.org/2000/svg">
                                 <rect width="800" height="400" fill="var(--bg-main)" rx="10" ry="10" />
                                 
                                 <rect x="50" y="50" width="180" height="70" rx="10" ry="10" fill="#e0e7ff" stroke="#4f46e5" stroke-width="2" />
                                 <text x="140" y="80" font-family="Arial, sans-serif" font-size="17" text-anchor="middle">Get Cover Image</text>
                                 <text x="140" y="100" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Pixel Data</text>
 
                                 <rect x="310" y="50" width="180" height="70" rx="10" ry="10" fill="#e0e7ff" stroke="#4f46e5" stroke-width="2" />
                                 <text x="400" y="80" font-family="Arial, sans-serif" font-size="17" text-anchor="middle">Get AES Key</text>
                                 <text x="400" y="100" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">(32 Bytes)</text>
 
                                 <rect x="50" y="170" width="180" height="70" rx="10" ry="10" fill="#ecfdf5" stroke="#059669" stroke-width="2" />
                                 <text x="140" y="200" font-family="Arial, sans-serif" font-size="17" text-anchor="middle">Derive Master Key</text>
                                 <text x="140" y="220" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">(from fixed pixels)</text>
 
                                 <rect x="310" y="170" width="180" height="70" rx="10" ry="10" fill="#ecfdf5" stroke="#059669" stroke-width="2" />
                                 <text x="400" y="190" font-family="Arial, sans-serif" font-size="17" text-anchor="middle">Encrypt AES Key</text>
                                 <text x="400" y="210" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">with Master Key</text>
                                 <text x="400" y="230" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">(e.g., XOR)</text>
 
                                 <rect x="570" y="170" width="180" height="70" rx="10" ry="10" fill="#e0f2fe" stroke="#0284c7" stroke-width="2" />
                                 <text x="660" y="190" font-family="Arial, sans-serif" font-size="17" text-anchor="middle">Prepare Payload</text>
                                 <text x="660" y="210" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Marker + Length +</text>
                                 <text x="660" y="230" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Encrypted Key + Message</text>
 
                                 <rect x="310" y="290" width="180" height="60" rx="10" ry="10" fill="#f3e8ff" stroke="#a855f7" stroke-width="2" />
                                 <text x="400" y="325" font-family="Arial, sans-serif" font-size="17" text-anchor="middle">Embed Payload (LSB)</text>
 
                                
                                 <line x1="140" y1="120" x2="140" y2="170" stroke="var(--text-muted)" stroke-width="2" marker-end="url(#arrow)" />
                                 <line x1="230" y1="205" x2="310" y2="205" stroke="var(--text-muted)" stroke-width="2" marker-end="url(#arrow)" />
                                 <line x1="400" y1="120" x2="400" y2="170" stroke="var(--text-muted)" stroke-width="2" marker-end="url(#arrow)" />
                                 <line x1="490" y1="205" x2="570" y2="205" stroke="var(--text-muted)" stroke-width="2" marker-end="url(#arrow)" />
                                 <line x1="400" y1="240" x2="400" y2="290" stroke="var(--text-muted)" stroke-width="2" marker-end="url(#arrow)" />
                                 <line x1="660" y1="240" x2="490" y2="310" stroke="var(--text-muted)" stroke-width="2" marker-end="url(#arrow)" />
 
                                 <defs>
                                   <marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
                                     <path d="M 0 0 L 10 5 L 0 10 z" fill="var(--text-muted)" />
                                   </marker>
                                 </defs>
                            </svg>
                          </div>
                      </div> 
                         <div class="info-box">
                             <p><strong>Process:</strong>
                             <ol>
                                 <li>A 'master key' is derived from fixed pixel locations in the cover image (e.g., corners).</li>
                                 <li>The actual AES key (32 bytes) is encrypted using this master key (e.g., simple XOR cipher).</li>
                                 <li>The encrypted key, along with a marker (`11111111`) and its length indicator, is prepended to the main message payload before LSB embedding.</li>
                             </ol>
                             </p>
                          </div>
                       </div>
                     </div>
                    </div>

                  <div class="flowchart-content" id="key-extraction">
                     <div class="process-step" style="border-bottom: none;"> 
                        <div class="step-number">X</div> 
                       <div class="step-content">
                         <h3>Automatic Key Extraction</h3>
                         <p>During message extraction, the system first checks for the presence of an embedded key marker within the initial bits read from the stego-image.</p>
                         <div class="flowchart-container" style="margin-top: 1.5rem;">
                         
                          <div class="chart">
                             <svg viewBox="0 0 800 500" width="100%" height="auto" xmlns="http://www.w3.org/2000/svg">
                                 <rect width="800" height="500" fill="var(--bg-main)" rx="10" ry="10" />
                                
                                 <rect x="310" y="30" width="180" height="70" rx="10" ry="10" fill="#e0e7ff" stroke="#4f46e5" stroke-width="2" />
                                 <text x="400" y="60" font-family="Arial, sans-serif" font-size="17" text-anchor="middle">Get Stego Image</text>
                                 <text x="400" y="80" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Pixel Data</text>
 
                                 <rect x="310" y="140" width="180" height="70" rx="10" ry="10" fill="#ecfdf5" stroke="#059669" stroke-width="2" />
                                 <text x="400" y="170" font-family="Arial, sans-serif" font-size="17" text-anchor="middle">Read Header Bits</text>
                                 <text x="400" y="190" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">(e.g., first 40 LSBs)</text>
 
                                 <polygon points="310,250 490,250 400,330" fill="e0e7ff" stroke="#0284c7" stroke-width="2" />
                                 <text x="400" y="285" font-family="Arial, sans-serif" font-size="17" text-anchor="middle">Key Marker?</text>
                                 <text x="400" y="305" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">(e.g., '11111111')</text>
 
                                 <rect x="50" y="370" width="180" height="70" rx="10" ry="10" fill="#f3e8ff" stroke="#a855f7" stroke-width="2" />
                                 <text x="140" y="400" font-family="Arial, sans-serif" font-size="17" text-anchor="middle">Use Provided Key</text>
                                 <text x="140" y="420" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">(if available)</text>
 
                                 <rect x="310" y="370" width="180" height="100" rx="10" ry="10" fill="#ecfdf5" stroke="#059669" stroke-width="2" />
                                 <text x="400" y="395" font-family="Arial, sans-serif" font-size="15" text-anchor="middle">Extract Encrypted Key</text>
                                 <text x="400" y="415" font-family="Arial, sans-serif" font-size="13" text-anchor="middle">(Next 256 bits)</text>
                                 <text x="400" y="435" font-family="Arial, sans-serif" font-size="13" text-anchor="middle">Derive Master Key</text>
                                 <text x="400" y="455" font-family="Arial, sans-serif" font-size="13" text-anchor="middle">(from fixed pixels)</text>
 
                                 <rect x="570" y="370" width="180" height="70" rx="10" ry="10" fill="#e0e7ff" stroke="#4f46e5" stroke-width="2" />
                                 <text x="660" y="395" font-family="Arial, sans-serif" font-size="17" text-anchor="middle">Decrypt Key</text>
                                 <text x="660" y="415" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">(using Master Key)</text>
 
                                 
                                 <line x1="400" y1="100" x2="400" y2="140" stroke="var(--text-muted)" stroke-width="2" marker-end="url(#arrow)" />
                                 <line x1="400" y1="210" x2="400" y2="250" stroke="var(--text-muted)" stroke-width="2" marker-end="url(#arrow)" />
                                 <line x1="310" y1="290" x2="140" y2="370" stroke="var(--text-muted)" stroke-width="2" marker-end="url(#arrow)" />
                                 <text x="240" y="340" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">No</text>
                                 <line x1="400" y1="330" x2="400" y2="370" stroke="var(--text-muted)" stroke-width="2" marker-end="url(#arrow)" />
                                 <text x="420" y="350" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Yes</text>
                                 <line x1="490" y1="420" x2="570" y2="405" stroke="var(--text-muted)" stroke-width="2" marker-end="url(#arrow)" />
 
                                 <defs>
                                   <marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
                                     <path d="M 0 0 L 10 5 L 0 10 z" fill="var(--text-muted)" />
                                   </marker>
                                 </defs>
                            </svg>
                          </div>
                      </div>
                         
                         
                         
                         <div class="info-box">
                             <p><strong>Process:</strong>
                             <ol>
                                 <li>Read initial header bits (e.g., first 40 bits) from the stego-image LSBs.</li>
                                 <li>Check if the first 8 bits match the key marker (`11111111`).</li>
                                 <li>If marker found, extract the encrypted key data based on its known length (32 bytes * 8 bits/byte = 256 bits).</li>
                                 <li>Derive the 'master key' from the same fixed pixel locations in the *stego-image*.</li>
                                 <li>Decrypt the embedded key using the derived master key (e.g., XOR).</li>
                                 <li>If decryption is successful, use this extracted key for AES message decryption.</li>
                                 <li>If no marker or decryption fails, use the user-provided key (if any).</li>
                             </ol>
                             </p>
                          </div>
                       </div>
                     </div>
                     
                     
                  </div>

                   <div class="flowchart-content" id="key-security">
                     <div class="process-step">
                       <div class="step-number">S</div>
                       <div class="step-content">
                         <h3>Key Security Considerations</h3>
                         <p>The overall security hinges on the secrecy of the AES key. Embedding offers convenience but introduces specific considerations:</p>
                         <div class="info-box">
                           <ul>
                             <li><strong>Master Key Weakness:</strong> The security of the embedded key depends entirely on the unpredictability of the pixels used to derive the master key and the simplicity of the encryption used for embedding (e.g., XOR). If an attacker knows the pixel locations and the image has low complexity (large flat areas), they might brute-force or analyze the master key.</li>
                             <li><strong>No Forward Secrecy:</strong> If a master key derivation method (pixel locations) is compromised, all past and future messages using that method with similar images might be vulnerable if the stego-images are available.</li>
                             <li><strong>Recommendation:</strong> For maximum security, <strong>avoid embedding the key</strong> and transmit it securely via a separate channel (e.g., end-to-end encrypted chat like Signal, PGP email, secure password manager). Embedding is a trade-off favoring convenience over absolute security.</li>
                           </ul>
                         </div>
                         <div class="code-block">
                          <pre><code class="language-python">
            master_key = bytes([
                    img_array[0, 0, 0] % 256,       # Top-left pixel, red
                    img_array[0, 0, 1] % 256,       # Top-left pixel, green
                    img_array[0, 0, 2] % 256,       # Top-left pixel, blue
                    img_array[h//2, w//2, 0] % 256, # Center pixel, red
                    img_array[h//2, w//2, 1] % 256, # Center pixel, green
                    img_array[h//2, w//2, 2] % 256, # Center pixel, blue
                    img_array[h-1, w-1, 0] % 256,   # Bottom-right pixel, red
                    img_array[h-1, w-1, 1] % 256,   # Bottom-right pixel, green
                   # ... (additional fixed pixel values) ...
                        ])
                          </code></pre>
                        </div>
                         
                       </div>
                     </div>
                  </div>
               </div>
            </section>
            
<!-- 5. Hiding Process Section -->
<section id="hiding" class="section">
  <div class="section-header">
    <i class="fas fa-eye-slash"></i>
    <h2 data-toc="Hiding Process">Message Hiding Process</h2>
  </div>
  <p>Embedding a secret message involves several sequential steps, transforming the plaintext message into modified pixel data within the cover image.</p>
  <div class="flowchart-container" style="margin-top: 2rem;">
    <h3>Hiding Flow Overview</h3>
    <div class="chart">
      <svg viewBox="0 0 1100 550" width="100%" height="auto" xmlns="http://www.w3.org/2000/svg">
          <rect width="1100" height="550" fill="var(--bg-main)" rx="10" ry="10"></rect>
         
          <circle cx="100" cy="100" r="40" fill="#4f46e5" stroke="white" stroke-width="2"></circle>
          <text x="100" y="105" font-family="Arial, sans-serif" font-size="18" text-anchor="middle" fill="white">Start</text>

          
          <rect x="50" y="190" width="180" height="200" rx="10" ry="10" fill="#f3e8ff" stroke="#a855f7" stroke-width="2"></rect>
          <text x="140" y="220" font-family="Arial, sans-serif" font-size="18" text-anchor="middle" font-weight="bold">Input</text>
          <line x1="70" y1="235" x2="210" y2="235" stroke="#a855f7" stroke-width="1"></line>
          <text x="70" y="265" font-family="Arial, sans-serif" font-size="15" text-anchor="start"> Cover Image</text>
          <text x="70" y="295" font-family="Arial, sans-serif" font-size="15" text-anchor="start"> Secret Message</text>
          <text x="70" y="325" font-family="Arial, sans-serif" font-size="15" text-anchor="start"> AES Key</text>
          <text x="70" y="355" font-family="Arial, sans-serif" font-size="15" text-anchor="start"> Settings (Embed Key?,</text>
          <text x="80" y="375" font-family="Arial, sans-serif" font-size="15" text-anchor="start">Enhanced LSB?)</text>

          
          <rect x="280" y="80" width="200" height="80" rx="10" ry="10" fill="#e0e7ff" stroke="#4f46e5" stroke-width="2"></rect>
          <text x="380" y="110" font-family="Arial, sans-serif" font-size="17" text-anchor="middle">Encrypt Message</text>
          <text x="380" y="135" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">(AES-256 + IV)</text>

          <rect x="280" y="190" width="200" height="80" rx="10" ry="10" fill="#e0e7ff" stroke="#4f46e5" stroke-width="2"></rect>
          <text x="380" y="220" font-family="Arial, sans-serif" font-size="17" text-anchor="middle">Base64 Encode</text>
          <text x="380" y="245" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">(IV+Ciphertext)</text>

          <rect x="280" y="300" width="200" height="80" rx="10" ry="10" fill="#e0e7ff" stroke="#4f46e5" stroke-width="2"></rect>
          <text x="380" y="325" font-family="Arial, sans-serif" font-size="17" text-anchor="middle">Prepare Header</text>
          <text x="380" y="350" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">&amp; Embed Key (Opt.)</text>

          <rect x="530" y="190" width="200" height="80" rx="10" ry="10" fill="#e0e7ff" stroke="#4f46e5" stroke-width="2"></rect>
          <text x="630" y="215" font-family="Arial, sans-serif" font-size="17" text-anchor="middle">Assemble Payload</text>
          <text x="630" y="240" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">(Header + Key? + Msg)</text>
          <text x="630" y="260" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Convert to Binary</text>


          <polygon points="780,130 980,130 930,210 830,210"  fill="#c0f2fe" stroke="#059669" stroke-width="2"></polygon>
          <text x="880" y="165" font-family="Arial, sans-serif" font-size="17" text-anchor="middle">Enhanced</text>
          <text x="880" y="185" font-family="Arial, sans-serif" font-size="17" text-anchor="middle">LSB?</text>

          <rect x="680" y="270" width="200" height="80" rx="10" ry="10" fill="#ecfdf5" stroke="#059669" stroke-width="2"></rect>
          <text x="780" y="310" font-family="Arial, sans-serif" font-size="17" text-anchor="middle">Embed w/ Simple LSB</text>
          <text x="780" y="335" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">(R, G, B channels)</text>

          <rect x="900" y="270" width="200" height="80" rx="10" ry="10" fill="#ecfdf5" stroke="#059669" stroke-width="2"></rect>
          <text x="1000" y="300" font-family="Arial, sans-serif" font-size="17" text-anchor="middle">Embed w/ Enhanced</text>
          <text x="1000" y="325" font-family="Arial, sans-serif" font-size="17" text-anchor="middle">LSB</text>
          <text x="1000" y="345" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">(Intensity-based)</text>

          <rect x="790" y="400" width="200" height="80" rx="10" ry="10" fill="#e0f2fe" stroke="#0284c7" stroke-width="2"></rect>
          <text x="890" y="430" font-family="Arial, sans-serif" font-size="17" text-anchor="middle">Save Stego Image</text>
          <text x="890" y="455" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">(Lossless: PNG, BMP)</text>

          
          <circle cx="890" cy="510" r="40" fill="#059669" stroke="white" stroke-width="2"></circle>
          <text x="890" y="515" font-family="Arial, sans-serif" font-size="18" text-anchor="middle" fill="white">End</text>

          
          <line x1="140" y1="100" x2="280" y2="100" stroke="var(--text-muted)" stroke-width="2" marker-end="url(#arrow)"></line>
          <line x1="140" y1="190" x2="140" y2="180" stroke="var(--text-muted)" stroke-width="2"></line>
          <line x1="140" y1="180" x2="280" y2="230" stroke="var(--text-muted)" stroke-width="2" marker-end="url(#arrow)"></line>
          <line x1="140" y1="390" x2="280" y2="340" stroke="var(--text-muted)" stroke-width="2" marker-end="url(#arrow)"></line>

          <line x1="480" y1="120" x2="530" y2="190" stroke="var(--text-muted)" stroke-width="2" marker-end="url(#arrow)"></line>
          <line x1="480" y1="230" x2="530" y2="230" stroke="var(--text-muted)" stroke-width="2" marker-end="url(#arrow)"></line>
          <line x1="480" y1="340" x2="530" y2="270" stroke="var(--text-muted)" stroke-width="2" marker-end="url(#arrow)"></line>

          <line x1="730" y1="230" x2="780" y2="170" stroke="var(--text-muted)" stroke-width="2" marker-end="url(#arrow)"></line>

          <line x1="830" y1="170" x2="780" y2="270" stroke="var(--text-muted)" stroke-width="2" marker-end="url(#arrow)"></line>
          <text x="800" y="230" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">No</text>
          <line x1="930" y1="210" x2="1000" y2="270" stroke="var(--text-muted)" stroke-width="2" marker-end="url(#arrow)"></line>
          <text x="960" y="245" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Yes</text>

          <line x1="780" y1="350" x2="840" y2="400" stroke="var(--text-muted)" stroke-width="2" marker-end="url(#arrow)"></line>
          <line x1="1000" y1="350" x2="940" y2="400" stroke="var(--text-muted)" stroke-width="2" marker-end="url(#arrow)"></line>

          <line x1="890" y1="480" x2="890" y2="510" stroke="var(--text-muted)" stroke-width="2"></line>


          <defs>
            <marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
              <path d="M 0 0 L 10 5 L 0 10 z" fill="var(--text-muted)"></path>
            </marker>
          </defs>
      </svg>
    </div>
  </div>

  <div class="tabbed-section-container">
    <div class="flowchart-tabs">
      <div class="flowchart-tab active" data-target="hiding-prep">1. Preparation</div>
      <div class="flowchart-tab" data-target="hiding-embed">2. Embedding</div>
      <div class="flowchart-tab" data-target="hiding-save">3. Saving</div>
    </div>

    

    <div class="flowchart-content active" id="hiding-prep">
      <div class="process-step">
        <div class="step-number">P</div>
        <div class="step-content">
          <h3>Message Preparation</h3>
          <p>The raw text message undergoes several transformations before it's ready for embedding:</p>
          <div class="info-box1">
            <ol>
              <li><strong>Encryption (Optional):</strong> If AES is enabled, the message is encrypted using the provided key.
                A unique 16-byte <span class="tooltip">Initialization Vector (IV)<span class="tooltip-text">A random block of data used with block cipher modes like CBC to ensure that the same plaintext encrypts to different ciphertexts each time. Essential for security.</span></span> is generated and prepended to the ciphertext.</li>
              <li><strong>Encoding:</strong> The (potentially encrypted) message bytes (IV + Ciphertext)
                 are encoded using Base64. This converts binary data into standard ASCII characters, preventing issues during binary conversion and embedding.</li>
              <li><strong>Error Correction (Optional):</strong> Basic error correction codes (like simple 
                repetition or parity bits) might be added to the Base64 string to provide minimal resilience against bit errors. (Note: Current implementation may not include robust ECC).</li>
              <li><strong>Header Construction:</strong> A header is constructed, typically containing:
                <ul>
                  <li>A marker bit/byte (e.g., `1` if key embedded, `0` if not).</li>
                  <li>The total length (in bits) of the subsequent payload (Encoded Message + Optional Encrypted Key).</li>
                  <li>(Optional: Marker for embedding strategy used).</li>
                </ul>
              </li>
              <li><strong>Key Embedding (Optional):</strong> If chosen, the encrypted AES key is prepended to the encoded message.</li>
              <li><strong>Payload Formation:</strong> The final payload is assembled: `Header + Optional_Encrypted_Key + Encoded_Message`.</li>
              <li><strong>Binary Conversion:</strong> The complete payload string is converted into a single stream of binary digits (0s and 1s).</li>
            </ol>
          </div>
          <div class="code-block">
            <pre><code class="language-python">
    # Simplified Python Snippet (Encryption & Encoding)
    from Crypto.Cipher import AES
    from Crypto.Random import get_random_bytes
    from Crypto.Util.Padding import pad
    import base64
    import binascii # Assuming needed for key hex conversion
    
    def prepare_message_payload(message, hex_key, embed_key=False, encrypted_key=None):
        """Illustrative preparation (excluding header/binary conversion)."""
        message_bytes = message.encode('utf-8')
    
        # 1. Encrypt message
        key_bytes = binascii.unhexlify(hex_key)
        iv = get_random_bytes(AES.block_size) # 16 bytes for AES
        cipher = AES.new(key_bytes, AES.MODE_CBC, iv)
        ciphertext = cipher.encrypt(pad(message_bytes, AES.block_size))
        encrypted_data_with_iv = iv + ciphertext
    
        # 2. Encode message to Base64
        encoded_message = base64.b64encode(encrypted_data_with_iv).decode('utf-8')
    
        # 3. Add optional encrypted key (already encrypted and base64 encoded)
        payload_string = encoded_message
        if embed_key and encrypted_key:
            # Assume encrypted_key is already b64 encoded bytes/string
            payload_string = encrypted_key.decode('utf-8') + payload_string # Simplified concatenation
    
        # 4. Header needs to be prepended here (marker + length)
        # 5. Convert final_payload_string to binary bits (not shown)
        # payload_bits = string_to_binary(final_payload_string_with_header)
    
        return payload_string # Returns encoded string before header/binary conversion
    
    # encrypted_b64_payload = prepare_message_payload("Secret", "key_hex", ...)
            </code></pre>
          </div>
        </div>
      </div>
    </div>
  
    <div class="flowchart-content" id="hiding-embed">
      <div class="process-step">
        <div class="step-number">E</div> 
        <div class="step-content">
          <h3>LSB Embedding Strategy</h3>
          <p>The binary data stream is embedded into the cover image pixel by pixel, modifying the Least Significant Bits (LSBs) of the color channels (Red, Green, Blue).</p>
          <div class="info-box">
            <p>Two strategies are available:</p>
            <ul>
              <li><strong>Simple LSB:</strong> Embeds bits sequentially across R, G, B channels for all pixels until the data is hidden. Offers maximum capacity (~3 bits per pixel, bpp) but is statistically easier to detect via steganalysis.</li>
              <li><strong>Enhanced (Adaptive) LSB:</strong> Calculates pixel intensity (average of R, G, B) and selects only *two* specific channels for embedding based on whether the pixel is dark, medium, or bright (see visualization below). Offers slightly lower capacity (~2 bpp) but aims for better imperceptibility and resistance to basic statistical steganalysis.</li>
            </ul>
            <p>The system iterates through pixels, modifying the LSB of the chosen channel(s) with the next bit(s) from the binary payload stream until all payload bits are embedded.</p>
          </div>
        </div>
      </div>
    </div>

    <div class="flowchart-content" id="hiding-save">
      <div class="process-step">
        <div class="step-number">S</div>
        <div class="step-content">
          <h3>Image Saving</h3>
          <p>After embedding the complete binary payload, the modified pixel data forms the final stego-image.</p>
          <div class="info-box">
            <p><strong style="color: var(--error);"><i class="fas fa-exclamation-triangle"></i> Critical:</strong> The stego-image <strong>MUST</strong> be saved in a <strong>lossless format</strong> (e.g., PNG, BMP, TIFF).</p>
            <p>Saving in a lossy format like JPEG will apply compression algorithms that discard fine details, including the LSB modifications, thereby irretrievably destroying the hidden data.</p>
          </div>
          <div class="code-block">
            <pre><code class="language-python">
from PIL import Image
import numpy as np

def save_stego_image(pixel_array, output_path):
    """Saves the modified pixel array as a lossless image."""
    try:
        # Ensure the array is in uint8 format for saving
        if pixel_array.dtype != np.uint8:
            # Clip values just in case they went out of 0-255 range
            pixel_array = np.clip(pixel_array, 0, 255).astype(np.uint8)

        stego_image = Image.fromarray(pixel_array)

        # Save as PNG (lossless)
        stego_image.save(output_path, format='PNG')
        print(f"Stego image saved successfully to {output_path}")

    except Exception as e:
        print(f"Error saving stego image: {e}")

# Assuming modified_pixels is the NumPy array after LSB embedding
# save_stego_image(modified_pixels, "output_stego_image.png")
            </code></pre>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>          

             <!-- 7. Extraction Process Section -->
            <section id="extraction" class="section">
              <div class="section-header">
                <i class="fas fa-search-plus"></i> 
                <h2 data-toc="Extraction Process">Message Extraction Process</h2>
              </div>
              <p>Extracting the hidden message reverses the hiding process, retrieving the binary data from the stego-image and reconstructing the original message.</p>
              <div class="chart">
                <svg viewBox="0 0 1000 500" width="100%" height="auto" xmlns="http://www.w3.org/2000/svg">
                  <!-- Background -->
                  <rect width="1000" height="500" fill="#ffffff" rx="10" ry="10"></rect>
      
                  <!-- Start node -->
                  <circle cx="100" cy="100" r="30" fill="#4f46e5"></circle>
                  <text x="100" y="105" font-family="Arial" font-size="14" text-anchor="middle" fill="white">Start</text>
      
                  <!-- Input Box -->
                  <rect x="50" y="180" width="150" height="140" rx="10" ry="10" fill="#f3e8ff" stroke="#a855f7" stroke-width="2"></rect>
                  <text x="125" y="205" font-family="Arial" font-size="14" text-anchor="middle" font-weight="bold">Input</text>
                  <line x1="75" y1="220" x2="175" y2="220" stroke="#a855f7" stroke-width="1"></line>
                  <text x="75" y="245" font-family="Arial" font-size="12" text-anchor="start"> Stego Image</text>
                  <text x="75" y="270" font-family="Arial" font-size="12" text-anchor="start"> Key (optional)</text>
                  <text x="75" y="295" font-family="Arial" font-size="12" text-anchor="start"> AES Setting</text>
                  <text x="75" y="320" font-family="Arial" font-size="12" text-anchor="start"> Bit Strategy</text>
      
                  <!-- Read Header -->
                  <rect x="250" y="80" width="160" height="60" rx="10" ry="10" fill="#e0e7ff" stroke="#4f46e5" stroke-width="2"></rect>
                  <text x="330" y="105" font-family="Arial" font-size="14" text-anchor="middle">Read Header</text>
                  <text x="330" y="125" font-family="Arial" font-size="12" text-anchor="middle">(marker + length)</text>
      
                  <!-- Extract Data Based on Strategy -->
                  <polygon points="450,60 600,60 575,140 425,140" fill="#ecfdf5" stroke="#059669" stroke-width="2"></polygon>
                  <text x="512.5" y="95" font-family="Arial" font-size="14" text-anchor="middle">Enhanced Bit?</text>
                  <text x="512.5" y="115" font-family="Arial" font-size="12" text-anchor="middle">Check setting</text>
      
                  <!-- Extract with Simple LSB -->
                  <rect x="400" y="180" width="160" height="60" rx="10" ry="10" fill="#ecfdf5" stroke="#059669" stroke-width="2"></rect>
                  <text x="480" y="205" font-family="Arial" font-size="14" text-anchor="middle">Extract with</text>
                  <text x="480" y="225" font-family="Arial" font-size="12" text-anchor="middle">Simple LSB</text>
      
                  <!-- Extract with Enhanced LSB -->
                  <rect x="600" y="180" width="160" height="60" rx="10" ry="10" fill="#ecfdf5" stroke="#059669" stroke-width="2"></rect>
                  <text x="680" y="205" font-family="Arial" font-size="14" text-anchor="middle">Extract with</text>
                  <text x="680" y="225" font-family="Arial" font-size="12" text-anchor="middle">Enhanced LSB</text>
      
                  <!-- Extract Key if Present -->
                  <rect x="400" y="280" width="160" height="60" rx="10" ry="10" fill="#e0e7ff" stroke="#4f46e5" stroke-width="2"></rect>
                  <text x="480" y="305" font-family="Arial" font-size="14" text-anchor="middle">Extract Key</text>
                  <text x="480" y="325" font-family="Arial" font-size="12" text-anchor="middle">(if key marker present)</text>
      
                  <!-- Apply Error Correction -->
                  <rect x="600" y="280" width="160" height="60" rx="10" ry="10" fill="#e0e7ff" stroke="#4f46e5" stroke-width="2"></rect>
                  <text x="680" y="305" font-family="Arial" font-size="14" text-anchor="middle">Apply Error</text>
                  <text x="680" y="325" font-family="Arial" font-size="12" text-anchor="middle">Correction</text>
      
                  <!-- AES Decryption Decision -->
                  <polygon points="450,380 600,380 575,460 425,460" fill="#ecfdf5" stroke="#059669" stroke-width="2"></polygon>
                  <text x="512.5" y="415" font-family="Arial" font-size="14" text-anchor="middle">AES Used?</text>
      
                  <!-- AES Decryption -->
                  <rect x="650" y="400" width="160" height="60" rx="10" ry="10" fill="#e0e7ff" stroke="#4f46e5" stroke-width="2"></rect>
                  <text x="730" y="425" font-family="Arial" font-size="14" text-anchor="middle">Decrypt with AES</text>
                  <text x="730" y="445" font-family="Arial" font-size="12" text-anchor="middle">(using key)</text>
      
                  <!-- End node -->
                  <circle cx="900" cy="430" r="30" fill="#059669"></circle>
                  <text x="900" y="435" font-family="Arial" font-size="14" text-anchor="middle" fill="white">End</text>
      
                  <!-- Arrows -->
                  <line x1="130" y1="100" x2="250" y2="100" stroke="#6b7280" stroke-width="2" marker-end="url(#arrow)"></line>
                  <line x1="130" y1="250" x2="250" y2="180" stroke="#6b7280" stroke-width="2" marker-end="url(#arrow)"></line> <!-- Connect Input to Read Header -->
      
                  <line x1="410" y1="110" x2="425" y2="110" stroke="#6b7280" stroke-width="2" marker-end="url(#arrow)"></line>
      
                  <line x1="425" y1="100" x2="400" y2="180" stroke="#6b7280" stroke-width="2" marker-end="url(#arrow)"></line>
                  <text x="400" y="150" font-family="Arial" font-size="12" text-anchor="start">No</text>
      
                  <line x1="600" y1="100" x2="600" y2="180" stroke="#6b7280" stroke-width="2" marker-end="url(#arrow)"></line>
                  <text x="610" y="150" font-family="Arial" font-size="12" text-anchor="start">Yes</text>
      
                  <line x1="480" y1="240" x2="480" y2="280" stroke="#6b7280" stroke-width="2" marker-end="url(#arrow)"></line>
                  <line x1="680" y1="240" x2="680" y2="280" stroke="#6b7280" stroke-width="2" marker-end="url(#arrow)"></line>
      
                  <line x1="480" y1="340" x2="480" y2="380" stroke="#6b7280" stroke-width="2" marker-end="url(#arrow)"></line>
                  <line x1="680" y1="340" x2="512.5" y2="380" stroke="#6b7280" stroke-width="2" marker-end="url(#arrow)"></line>
      
                  <line x1="600" y1="420" x2="650" y2="420" stroke="#6b7280" stroke-width="2" marker-end="url(#arrow)"></line>
                  <text x="615" y="410" font-family="Arial" font-size="12" text-anchor="start">Yes</text>
      
                  <line x1="425" y1="420" x2="870" y2="430" stroke="#6b7280" stroke-width="2" marker-end="url(#arrow)"></line>
                  <text x="400" y="440" font-family="Arial" font-size="12" text-anchor="start">No</text>
      
                  <line x1="810" y1="430" x2="870" y2="430" stroke="#6b7280" stroke-width="2" marker-end="url(#arrow)"></line>
                  <defs>
                    <marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
                      <path d="M 0 0 L 10 5 L 0 10 z" fill="#6b7280"></path>
                    </marker>
                  </defs>
                </svg>
              </div>

              <div class="tabbed-section-container"> 
                    <div class="flowchart-tabs">
                        <div class="flowchart-tab active" data-target="extraction-read">1. Data Extraction</div>
                        <div class="flowchart-tab" data-target="extraction-key">2. Key Determination</div>
                        <div class="flowchart-tab" data-target="extraction-reconstruct">3. Reconstruction</div>
                    </div>

                    
                    <div class="flowchart-content active" id="extraction-read">
                       <div class="process-step">
                         <div class="step-number">R</div> 
                        <div class="step-content">
                          <h3>Data Extraction & Header Parsing</h3>
                          <p>The process begins by reading the LSBs from the stego-image pixels according to the embedding strategy used (Simple or Enhanced, usually indicated by user setting or potentially another marker).</p>
                          <div class="info-box">
                             <ol>
                                 <li>The first set of bits (e.g., 40 bits, enough to contain the header) are extracted from the image LSBs using the selected strategy.</li>
                                 <li>This initial segment is parsed to identify the header information:
                                     <ul>
                                        <li>The key embedding marker (e.g., `11111111`).</li>
                                        <li>The total payload length (in bits).</li>
                                     </ul>
                                 </li>
                                 <li>Based on the determined length, the system continues extracting LSBs from the image until the entire binary payload stream (Header + Optional_Key + Message) of that length is retrieved.</li>
                             </ol>
                          </div>
                        </div>
                      </div>
                    </div>

                    
                    <div class="flowchart-content" id="extraction-key">
                      <div class="process-step">
                        <div class="step-number">K</div> 
                        <div class="step-content">
                          <h3>Key Determination</h3>
                          <p>The correct AES key for decryption is determined based on the parsed header and user input.</p>
                           <div class="info-box">
                             <ul>
                                 <li><strong>Embedded Key Found:</strong> If the header marker indicates an embedded key (`11111111`), the system extracts the next 256 bits (encrypted key). It then attempts to decrypt this using the master key derived from the stego-image's fixed pixel locations. If successful, this decrypted 32-byte key is used.</li>
                                 <li><strong>No Embedded Key / Extraction Failed:</strong> If the header marker indicates no embedded key, or if the embedded key extraction/decryption fails (e.g., wrong master key derived due to image modification, or incorrect marker interpretation), the system relies on the AES key explicitly provided by the user in the interface.</li>
                                 <li><strong>No Key Available:</strong> If AES decryption is expected (based on application settings or perhaps another header flag) but no key is available (neither successfully extracted nor provided by the user), the decryption process will fail, and only the raw (likely meaningless) Base64 data can be shown.</li>
                             </ul>
                          </div>
                            <div class="code-block">
                                <pre><code class="language-python">
# Simplified Python Snippet (Decryption)
from Crypto.Cipher import AES
from Crypto.Util.Padding import unpad
import base64
import binascii

def decrypt_message(encoded_message_b64, hex_key):
    """Decrypts Base64 encoded IV+Ciphertext using AES key."""
    key_bytes = binascii.unhexlify(hex_key)
    try:
        # Decode Base64 first
        encrypted_payload_with_iv = base64.b64decode(encoded_message_b64)

        # Extract IV (first 16 bytes)
        iv = encrypted_payload_with_iv[:AES.block_size]
        ciphertext = encrypted_payload_with_iv[AES.block_size:]

        cipher = AES.new(key_bytes, AES.MODE_CBC, iv)

        # Decrypt and remove padding
        decrypted_padded_message = cipher.decrypt(ciphertext)
        decrypted_message_bytes = unpad(decrypted_padded_message, AES.block_size)

        return decrypted_message_bytes.decode('utf-8')

    except (ValueError, KeyError, binascii.Error, base64.binascii.Error) as e:
        # Common errors: Incorrect key, corrupted data, invalid padding
        print(f"Decryption failed: {e}")
        return None
    except Exception as e:
        print(f"An unexpected error occurred during decryption: {e}")
        return None

# Assume extracted_b64_msg is the base64 string portion from payload
# final_key = determine_key_logic(...) # Logic to get key
# if final_key:
#    original_message = decrypt_message(extracted_b64_msg, final_key)
# else:
#    print("Cannot decrypt: No valid key found.")
                        </code></pre>
                      </div>
                        </div>
                      </div>
                    </div>
                    <div class="flowchart-content" id="extraction-reconstruct">
                      <div class="process-step">
                        <div class="step-number">M</div>
                        <div class="step-content">
                          <h3>Message Reconstruction</h3>
                          <!-- Content here -->
                          <p>The extracted binary payload is processed to recover the original plaintext message.</p>
                          <div class="info-box">
                             <ol>
                                 <li><strong>Payload Parsing:</strong> The binary payload is split based on the header information. If an embedded key was present, those bits are separated from the encoded message bits.</li>
                                 <li><strong>Error Correction Check (Optional):</strong> If ECC was used, checks/corrections are applied to the message bits.</li> 
                                 <li><strong>Binary to String:</strong> The binary bits corresponding to the encoded message are grouped into 8-bit bytes and converted back to an ASCII string (which should be the Base64 encoded data).</li>
                                 <li><strong>Base64 Decoding:</strong> The resulting Base64 string is decoded back into the original binary bytes (IV + Ciphertext).</li>
                                 <li><strong>Decryption (If Applicable):</strong> If the message was encrypted (determined by user setting or header info), the previously determined AES key is used to decrypt these bytes. The prepended IV is used, and padding is removed upon successful decryption.</li>
                                 <li><strong>UTF-8 Decoding:</strong> The final decrypted bytes (or the raw bytes if no encryption was used) are decoded using UTF-8 to reconstruct the original plaintext message.</li>
                             </ol>
                             <p>Error handling is crucial at each step (e.g., invalid Base64, incorrect padding during decryption often indicates a wrong key or corrupted data).</p>
                        </div>
                      </div>
                    </div>
                    
              </div> 

            </section>

             <!-- 8. Metrics Section -->
            <section id="metrics" class="section">
              <div class="section-header">
                <i class="fas fa-tachometer-alt"></i> 
                <h2 data-toc="Performance Metrics">Performance Metrics</h2>
              </div>
              <p>Evaluating the effectiveness of steganography involves measuring both the visual impact on the cover image and the integrity of the hidden data.</p>

              <div class="metrics-grid">
                <div class="metric-card">
                  <div class="metric-title"><span class="tooltip">PSNR<span class="tooltip-text">Peak Signal-to-Noise Ratio: Measures the ratio between the maximum possible power of a signal (image) and the power of corrupting noise (LSB changes). Higher values (in decibels, dB) indicate less distortion.</span></span></div>
                  <div class="metric-value">35-50+ dB</div>
                  <p>Indicates image quality degradation. Values &gt; 40 dB are often visually indistinguishable from the original to the human eye.</p>
                </div>

                <div class="metric-card">
                   <div class="metric-title"><span class="tooltip">SSIM<span class="tooltip-text">Structural Similarity Index Measure: Measures the perceived similarity between two images based on luminance, contrast, and structure. Ranges from -1 to 1, where 1 means identical images.</span></span></div>
                  <div class="metric-value">0.95-0.99+</div>
                  <p>Reflects perceived visual similarity. Values very close to 1 indicate the stego image looks almost identical to the original.</p>
                </div>

                <div class="metric-card">
                   <div class="metric-title"><span class="tooltip">Payload<span class="tooltip-text">The amount of secret data hidden relative to the total capacity of the cover medium. Often measured in bits per pixel (bpp) for images.</span></span> Capacity</div>
                  <div class="metric-value">~2 bpp (Enh.)</div>
                  <p>Max bits embeddable per pixel using Enhanced LSB (~3 bpp for Simple). Actual usable payload depends on message size & overhead.</p>
                </div>

                <div class="metric-card">
                   <div class="metric-title"><span class="tooltip">BER<span class="tooltip-text">Bit Error Rate: The number of bit errors detected during extraction divided by the total number of transferred bits. Should ideally be 0 for lossless transmission.</span></span></div>
                  <div class="metric-value">~0%</div>
                  <p>Measures data integrity. Should be zero if the stego-image wasn't altered (e.g., by compression) after embedding.</p>
                </div>
              </div>

              <div class="process-step">
                <div class="step-number" style="background: var(--success);"><i class="fas fa-calculator"></i></div>
                <div class="step-content">
                  <h3>Metrics Calculation</h3>
                  <p>PSNR and SSIM are calculated by comparing the original cover image pixel data with the final stego-image pixel data using libraries like `scikit-image` in Python.</p>
                  <div class="code-block">
                        <pre><code class="language-python">
from skimage.metrics import peak_signal_noise_ratio as psnr
from skimage.metrics import structural_similarity as ssim
import numpy as np
from PIL import Image

def calculate_metrics(original_image_path, stego_image_path):
    """Calculates PSNR and SSIM between two image files."""
    try:
        original_img = Image.open(original_image_path).convert('RGB')
        stego_img = Image.open(stego_image_path).convert('RGB')

        original_array = np.array(original_img, dtype=np.float64)
        stego_array = np.array(stego_img, dtype=np.float64)

        if original_array.shape != stego_array.shape:
            print("Error: Images must have the same dimensions.")
            return None, None

        # Calculate PSNR (data_range is max possible pixel value)
        # For RGB images, PSNR is often calculated on the Luminance channel,
        # or averaged across channels. scikit-image calculates MSE across all values.
        psnr_value = psnr(original_array, stego_array, data_range=255)

        # Calculate SSIM
        # For multichannel (color) images, set channel_axis=-1 (or 2 for older skimage)
        # data_range is essential for correct calculation.
        ssim_value, _ = ssim(original_array, stego_array, full=True,
                             data_range=255, channel_axis=-1, win_size=7) # Use channel_axis, win_size optional

        return psnr_value, ssim_value

    except FileNotFoundError:
        print("Error: One or both image files not found.")
        return None, None
    except Exception as e:
        print(f"Error calculating metrics: {e}")
        return None, None

# Example:
# psnr_result, ssim_result = calculate_metrics("cover.png", "stego.png")
# if psnr_result is not None:
#    print(f"PSNR: {psnr_result:.2f} dB")
#    print(f"SSIM: {ssim_result:.4f}")
                        </code></pre>
                      </div>
                       <div class="info-box">
                        <p><strong>Interpretation:</strong> Aim for high PSNR (&gt;40dB) and high SSIM (&gt;0.98) for optimal imperceptibility. Lower payloads generally yield better metrics. The actual values depend heavily on the cover image complexity and the amount of data hidden.</p>
                    </div>
                </div>
              </div>
            </section>

            

           <!-- 10. Security Analysis Section -->
<section id="security-analysis" class="section">
  <div class="section-header security">
    <i class="fas fa-shield-alt"></i>
    <h2 data-toc="Security Analysis">Security Analysis</h2>
  </div>
  <p>The security of this steganography system relies on two pillars: the cryptographic strength of AES-256 and the undetectability of the LSB modifications.</p>

  <div class="tabbed-section-container">
    <div class="flowchart-tabs">
      <div class="flowchart-tab active" data-target="security-steganalysis">1. Steganalysis Resistance</div>
      <div class="flowchart-tab" data-target="security-crypto">2. Cryptographic Security</div>
      <div class="flowchart-tab" data-target="security-vuln">3. Vulnerabilities & Best Practices</div>
    </div>

    <!-- First tab content -->
    <div class="flowchart-content active" id="security-steganalysis">
      <div class="process-step">
        <div class="step-number">S</div> 
        <div class="step-content">
          <h3>Steganalysis Resistance</h3>
          <p><span class="tooltip">Steganalysis<span class="tooltip-text">The art and science of detecting hidden messages embedded using steganography. It focuses on detecting the *presence* of hidden data, not necessarily reading it.</span></span> aims to detect the *presence* of hidden data. Our method employs techniques to resist common attacks:</p>
          <div class="info-box">
            <ul>
              <li><strong>Statistical Analysis:</strong> The Enhanced LSB method's adaptive channel selection avoids modifying LSBs uniformly across all channels. This makes simple first-order statistical attacks (like <span class="tooltip">Chi-Square<span class="tooltip-text">A statistical test comparing observed LSB frequencies against expected frequencies (usually near 50% 0s and 50% 1s) for an unmodified image. Basic LSB often creates detectable deviations.</span></span> analysis of LSBs) less effective than against basic LSB, which alters statistics more predictably.</li>
              <li><strong>Visual Imperceptibility:</strong> By limiting changes primarily to the LSBs and using the adaptive strategy, the visual difference between cover and stego images is minimized (quantified by high PSNR/SSIM), making detection by human observation difficult.</li>
              <li><strong>Payload Factor:</strong> Resistance is heavily dependent on payload size. Lower payloads (hiding less data relative to image capacity) modify fewer pixels, significantly increasing resistance to both visual and statistical detection. Hiding near maximum capacity makes detection much easier.</li>
              <li><strong>Limitations:</strong> Sophisticated steganalysis techniques (e.g., analyzing higher-order statistics, using machine learning classifiers trained on stego images) can still potentially detect LSB modifications, even with the enhanced method, especially with higher payloads or known cover images.</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- Second tab content -->
    <div class="flowchart-content" id="security-crypto">
      <div class="process-step">
        <div class="step-number">C</div> 
        <div class="step-content">
          <h3>Cryptographic Security</h3>
          <p>Even if the presence of hidden data is suspected or confirmed by steganalysis, the content remains confidential due to strong encryption:</p>
          <div class="info-box">
            <ul>
              <li><strong>AES-256 Strength:</strong> AES with a 256-bit key is a globally recognized, highly secure symmetric encryption standard, considered resistant to brute-force attacks with current and foreseeable computing technology.</li>
              <li><strong>Key Secrecy is Paramount:</strong> The entire cryptographic security depends fundamentally on keeping the 256-bit AES key secret. If the key is compromised (either the manually shared one or the one derived via the embedding mechanism), the encrypted message can be easily decrypted and read.</li>
              <li><strong>CBC Mode & IV:</strong> Using <span class="tooltip">Cipher Block Chaining (CBC)<span class="tooltip-text">An AES mode where each block of plaintext is XORed with the previous ciphertext block before being encrypted. This ensures identical plaintext blocks result in different ciphertext blocks, adding diffusion and preventing basic pattern analysis. Requires a unique, unpredictable Initialization Vector (IV) for each encryption.</span></span> mode with a unique, randomly generated IV for each encryption process prevents identical plaintext blocks from yielding identical ciphertext blocks. This is crucial for resisting pattern analysis attacks on the ciphertext. The IV is prepended to the ciphertext before Base64 encoding.</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- Third tab content -->
    <div class="flowchart-content" id="security-vuln">
      <div class="process-step">
        <div class="step-number">V</div>
        <div class="step-content">
          <h3>Vulnerabilities & Best Practices</h3>
          <p>Users must be aware of the inherent limitations and potential weaknesses of LSB steganography to use it effectively and securely:</p>
          <div class="info-box">
            <ul style="list-style: none; padding-left: 0;">
              <li><i class="fas fa-exclamation-triangle" style="color: var(--error); margin-right: 8px; width: 1em;"></i> <strong>Lossy Compression:</strong> <strong style="color: var(--error);">NEVER save or transmit the stego-image using lossy formats (JPEG/JPG, WEBP lossy, etc.).</strong> Use lossless formats (PNG, BMP, lossless WEBP, TIFF) exclusively. Lossy compression WILL destroy LSB data.</li>
              <li><i class="fas fa-exclamation-triangle" style="color: var(--error); margin-right: 8px; width: 1em;"></i> <strong>Image Manipulation:</strong> Any operation that re-calculates pixel values (resizing, cropping, significant filtering, rotation, color profile changes, automatic adjustments by platforms like social media) WILL likely corrupt or destroy the hidden LSB data. Transmit the stego-image file directly without modification.</li>
              <li><i class="fas fa-exclamation-triangle" style="color: var(--warning); margin-right: 8px; width: 1em;"></i> <strong>Known Cover Attack:</strong> If an attacker possesses both the original cover image and the stego-image, they can easily identify all modified LSBs by direct comparison. This reveals the hidden binary stream (though AES still protects the content if the key is secure). Use unique, non-public images as covers where possible if this is a concern.</li>
              <li><i class="fas fa-exclamation-triangle" style="color: var(--warning); margin-right: 8px; width: 1em;"></i> <strong>Key Handling:</strong> Securely manage and transmit the AES key if not using the embedding option. Avoid weak, guessable keys or reusing the same key across many unrelated messages or contexts. The security of embedded keys relies on the derivation method and image complexity (see Key Management).</li>
              <li><i class="fas fa-info-circle" style="color: var(--primary); margin-right: 8px; width: 1em;"></i> <strong>Capacity vs. Stealth:</strong> Hiding data near the maximum capacity (~2-3 bpp) significantly increases the statistical footprint and the likelihood of detection by steganalysis tools. For better stealth and security against detection, use lower payloads (e.g., below 1 bpp).</li>
              <li><i class="fas fa-info-circle" style="color: var(--primary); margin-right: 8px; width: 1em;"></i> <strong>Cover Image Choice:</strong> Complex, textured images (e.g., natural landscapes, detailed patterns) generally mask LSB changes better than images with large areas of flat color or smooth gradients (e.g., cartoons, simple graphics, skies).</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
             <!-- 11. Applications Section -->
            <section id="applications" class="section">
              <div class="section-header">
                <i class="fas fa-project-diagram"></i> 
                <h2 data-toc="Applications">Real-World Applications</h2>
              </div>
              <p>Steganography, particularly when combined with strong encryption, finds applications in various fields where covertness, data association, or enhanced security is required.</p>

                <div class="feature-grid">
                    <div class="feature-card topic-quality"> 
                        <h3><i class="fas fa-copyright"></i> Digital Watermarking</h3>
                        <p>Embedding imperceptible copyright notices, ownership details, or unique identifiers into digital media (images, audio, video) to deter unauthorized use, track distribution, and prove provenance.</p>
                        <div class="tags">
                            <span class="tag quality-assurance">IP Protection</span>
                            <span class="tag analysis">Authentication</span>
                        </div>
                    </div>

                    <div class="feature-card topic-security">
                        <h3><i class="fas fa-user-secret"></i> Covert Communication</h3>
                        <p>Transmitting sensitive information hidden within seemingly innocuous files (like images shared online), offering plausible deniability beyond standard encryption alone.</p>
                        <div class="tags">
                            <span class="tag security">Privacy</span>
                            <span class="tag encryption">Secure Messaging</span>
                        </div>
                    </div>

                    <div class="feature-card topic-advanced"> 
                        <h3><i class="fas fa-link"></i> Data Payload Association</h3>
                        <p>Embedding metadata or related small data directly within a primary file format. For example, attaching patient notes securely within a medical image (X-Ray, MRI), or embedding configuration data within a firmware image.</p>
                        <div class="tags">
                            <span class="tag advanced">Data Integrity</span>
                            <span class="tag convenience">Metadata</span>
                             <span class="tag analysis">Healthcare</span>
                        </div>
                    </div>

                     <div class="feature-card topic-security">
                        <h3><i class="fas fa-lock-open"></i> Tamper Detection</h3>
                        <p>Embedding a cryptographic hash or checksum of the original data (or parts of it) within the file's LSBs. Later, recomputing the hash and comparing it with the embedded value can reveal if the file has been modified.</p>
                        <div class="tags">
                            <span class="tag security">Integrity Check</span>
                            <span class="tag analysis">Verification</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 12. Comparison Section -->
            <section id="comparison" class="section">
              <div class="section-header">
                <i class="fas fa-balance-scale"></i>
                <h2 data-toc="Comparison">Comparison with Other Methods</h2>
              </div>
              <p>LSB modification is just one family of steganographic techniques. Here's how our Enhanced LSB compares to others in the spatial and frequency domains:</p>

              <div class="table-container">
                <table>
                  <thead>
                    <tr>
                      <th>Feature</th>
                      <th>Enhanced LSB (Ours)</th>
                      <th>Standard LSB</th>
                      <th><span class="tooltip">DCT-Based<span class="tooltip-text">Discrete Cosine Transform: Embeds data by modifying quantized coefficients in the frequency domain, common in JPEG compression. Examples: JSteg, F5.</span></span> (e.g., JSteg)</th>
                      <th><span class="tooltip">DWT-Based<span class="tooltip-text">Discrete Wavelet Transform: Embeds data across different frequency sub-bands (wavelet coefficients), often offering better robustness and imperceptibility than DCT for similar payloads.</span></span></th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><strong>Primary Domain</strong></td>
                      <td>Spatial (Pixel Values)</td>
                      <td>Spatial (Pixel Values)</td>
                      <td>Frequency (DCT Coeffs)</td>
                      <td>Frequency (Wavelet Coeffs)</td>
                    </tr>
                     <tr>
                      <td><strong>Visual Quality</strong></td>
                      <td><strong style="color: var(--success);">Excellent</strong> (High PSNR/SSIM)</td>
                      <td>Good (Moderate-High PSNR/SSIM)</td>
                      <td>Good (Depends on payload & algo)</td>
                      <td><strong style="color: var(--success);">Very Good</strong> (Often Higher PSNR)</td>
                    </tr>
                    <tr>
                      <td><strong>Payload Capacity</strong></td>
                      <td>High (~2 bpp)</td>
                      <td><strong style="color: var(--success);">Very High</strong> (~3 bpp)</td>
                      <td>Low-Medium</td>
                      <td>Low-Medium</td>
                    </tr>
                    <tr>
                      <td><strong>Robustness vs. Lossy Compression (JPEG)</strong></td>
                      <td><strong style="color: var(--error);">Very Low</strong> (Destroyed)</td>
                      <td><strong style="color: var(--error);">Very Low</strong> (Destroyed)</td>
                      <td><strong style="color: var(--warning);">Medium</strong> (Designed for JPEG)</td>
                      <td><strong style="color: var(--success);">Medium-High</strong></td>
                    </tr>
                    <tr>
                      <td><strong>Robustness vs. Filtering/Noise/Resizing</strong></td>
                      <td>Low</td>
                      <td>Low</td>
                      <td><strong style="color: var(--warning);">Medium</strong></td>
                      <td><strong style="color: var(--success);">Medium-High</strong></td>
                    </tr>
                     <tr>
                      <td><strong>Resistance vs. Basic Stats Analysis</strong></td>
                      <td><strong style="color: var(--warning);">Medium</strong></td>
                      <td>Low (Often detectable)</td>
                      <td><strong style="color: var(--warning);">Medium</strong> (Affects different stats)</td>
                      <td><strong style="color: var(--success);">Medium-High</strong></td>
                    </tr>
                     <tr>
                      <td><strong>Implementation Complexity</strong></td>
                      <td>Medium</td>
                      <td>Low</td>
                      <td>High</td>
                      <td>Very High</td>
                    </tr>
                     <tr>
                      <td><strong>Typical Host Media</strong></td>
                      <td>Lossless (PNG, BMP)</td>
                      <td>Lossless (PNG, BMP)</td>
                      <td>Primarily JPEG</td>
                      <td>Various (Often Lossless)</td>
                    </tr>
                  </tbody>
                </table>
              </div>
               <div class="info-box">
                    <p><strong>Key Takeaway:</strong> LSB methods (like ours) excel in **payload capacity** and **visual quality** for **lossless images**, but are extremely **fragile** against almost any image manipulation, especially lossy compression. Frequency-domain methods (DCT, DWT) trade lower capacity for significantly better **robustness**, making them more suitable for scenarios where the stego-image might undergo transformations (like sharing JPEGs online).</p>
                    <p>The choice depends heavily on the application's requirements for capacity, stealth, and robustness.</p>
              </div>
            </section>

             <!-- 13. Benchmarks Section -->
            <section id="benchmarks" class="section">
              <div class="section-header">
                <i class="fas fa-chart-line"></i>
                <h2 data-toc="Benchmarks">Performance Benchmarks</h2>
              </div>
              <p>Performance testing typically examines the relationship between the amount of data hidden (payload, often as bits per pixel - bpp) and the resulting image quality (PSNR, SSIM). These are illustrative benchmarks.</p>

              
               <div class="chart">
                    <svg viewBox="0 0 800 450" width="100%" height="auto" xmlns="http://www.w3.org/2000/svg">
                       <rect width="800" height="450" fill="var(--bg-main)" rx="10" ry="10" />
                       <text x="400" y="40" font-family="Arial, sans-serif" font-size="20" text-anchor="middle" font-weight="bold">PSNR vs. Payload (Illustrative Example)</text>
                       
                       <line x1="70" y1="380" x2="750" y2="380" stroke="var(--text-muted)" stroke-width="2.5" /> {/* X-axis */}
                       <line x1="70" y1="70" x2="70" y2="380" stroke="var(--text-muted)" stroke-width="2.5" /> {/* Y-axis */}
                      
                       <text x="170" y="405" font-family="Arial, sans-serif" font-size="15" text-anchor="middle">0.5 bpp</text>
                       <text x="340" y="405" font-family="Arial, sans-serif" font-size="15" text-anchor="middle">1.0 bpp</text>
                       <text x="510" y="405" font-family="Arial, sans-serif" font-size="15" text-anchor="middle">1.5 bpp</text>
                       <text x="680" y="405" font-family="Arial, sans-serif" font-size="15" text-anchor="middle">2.0 bpp</text>
                       <text x="410" y="435" font-family="Arial, sans-serif" font-size="16" text-anchor="middle">Payload (bits per pixel)</text>
                       
                       <text x="60" y="385" font-family="Arial, sans-serif" font-size="15" text-anchor="end">30</text>
                       <text x="60" y="307.5" font-family="Arial, sans-serif" font-size="15" text-anchor="end">40</text>
                       <text x="60" y="230" font-family="Arial, sans-serif" font-size="15" text-anchor="end">50</text>
                       <text x="60" y="152.5" font-family="Arial, sans-serif" font-size="15" text-anchor="end">60</text>
                       <text x="60" y="75" font-family="Arial, sans-serif" font-size="15" text-anchor="end">70</text>
                       <text x="25" y="225" font-family="Arial, sans-serif" font-size="16" text-anchor="middle" transform="rotate(-90, 25, 225)">PSNR (dB)</text>

                       
                       <line x1="70" y1="307.5" x2="750" y2="307.5" stroke="var(--card-border)" stroke-width="1" stroke-dasharray="5 5"/>
                       <line x1="70" y1="230" x2="750" y2="230" stroke="var(--card-border)" stroke-width="1" stroke-dasharray="5 5"/>
                       <line x1="70" y1="152.5" x2="750" y2="152.5" stroke="var(--card-border)" stroke-width="1" stroke-dasharray="5 5"/>
                       <line x1="170" y1="70" x2="170" y2="380" stroke="var(--card-border)" stroke-width="1" stroke-dasharray="5 5"/>
                       <line x1="340" y1="70" x2="340" y2="380" stroke="var(--card-border)" stroke-width="1" stroke-dasharray="5 5"/>
                       <line x1="510" y1="70" x2="510" y2="380" stroke="var(--card-border)" stroke-width="1" stroke-dasharray="5 5"/>
                       <line x1="680" y1="70" x2="680" y2="380" stroke="var(--card-border)" stroke-width="1" stroke-dasharray="5 5"/>

                      
                       <polyline points="170,191.5 340,269 510,320 680,360" stroke="var(--primary)" stroke-width="3.5" fill="none" marker-start="url(#dataPoint)" marker-mid="url(#dataPoint)" marker-end="url(#dataPoint)"/>
                        
                       <polyline points="170,230 340,307.5 510,355 680,380" stroke="var(--secondary)" stroke-width="2.5" fill="none" stroke-dasharray="8 4" />


                     
                        <rect x="550" y="70" width="180" height="80" rx="5" ry="5" fill="rgba(255,255,255,0.7)" stroke="var(--card-border)"/>
                        <line x1="565" y1="90" x2="595" y2="90" stroke="var(--primary)" stroke-width="3"/>
                        <circle cx="580" cy="90" r="4" fill="var(--primary)"/>
                        <text x="605" y="95" font-family="Arial, sans-serif" font-size="14">Enhanced LSB (Avg)</text>
                        <line x1="565" y1="120" x2="595" y2="120" stroke="var(--secondary)" stroke-width="2.5" stroke-dasharray="8 4"/>
                        <text x="605" y="125" font-family="Arial, sans-serif" font-size="14">Simple LSB (Avg)</text>

                       
                       <line x1="70" y1="307.5" x2="750" y2="307.5" stroke="var(--success)" stroke-width="2" stroke-dasharray="10 5"/>
                       <text x="745" y="300" font-family="Arial, sans-serif" font-size="13" text-anchor="end" fill="var(--success)">Imperceptible Threshold (~40 dB)</text>

                       <defs>
                         <marker id="dataPoint" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="8" markerHeight="8" orient="auto">
                           <circle cx="5" cy="5" r="4" fill="var(--primary)" />
                         </marker>
                       </defs>
                    </svg>
                  </div>

               <div class="process-step">
                 <div class="step-number">1</div>
                <div class="step-content">
                  <h3>Payload vs. Quality Trade-off</h3>
                  <p>As the illustrative chart shows, there's generally an inverse relationship: increasing the amount of hidden data (higher payload/bpp) leads to lower PSNR values (more distortion). Simple LSB offers higher capacity but typically results in lower PSNR compared to Enhanced LSB for the same payload.</p>
                  <div class="info-box">
                      <p>For optimal stealth (resistance against detection), it's recommended to use a payload significantly below the maximum capacity. Aiming for payloads that keep PSNR comfortably above 40-45 dB (e.g., potentially 0.5 - 1.0 bpp depending on the image) minimizes the statistical and visual footprint.</p>
                  </div>
                </div>
              </div>

               <div class="process-step">
                <div class="step-number">2</div>
                <div class="step-content">
                  <h3>Factors Influencing Benchmarks</h3>
                  <p>The exact PSNR/SSIM values achieved for a given payload depend heavily on several factors:</p>
                  <div class="info-box">
                     <ul>
                         <li><strong>Cover Image Content:</strong> Images with high texture, noise, and complexity (e.g., detailed landscapes, busy patterns) tend to mask LSB changes better, resulting in higher PSNR/SSIM values compared to images with large smooth areas or simple graphics.</li>
                         <li><strong>Embedding Strategy:</strong> Enhanced (Adaptive) LSB generally yields better PSNR/SSIM than Simple LSB for the same payload size due to its perceptually guided channel selection.</li>
                         <li><strong>Payload Size:</strong> This is often the most dominant factor. Hiding more bits inevitably modifies more pixels, directly impacting (lowering) the quality metrics.</li>
                          <li><strong>Implementation Details:</strong> Specific choices in header size, key embedding overhead, and binary conversion can slightly affect the final payload and thus the metrics.</li>
                     </ul>
                  </div>
                </div>
              </div>
            </section>

            <!-- 15. FAQ Section -->
            <section id="faq" class="section">
              <div class="section-header">
                <i class="fas fa-question-circle"></i>
                <h2 data-toc="FAQ">Frequently Asked Questions</h2>
              </div>
              <p>Common questions regarding the use and understanding of this steganography tool.</p>

              <div class="faq-container">
                <div class="faq-item">
                  <div class="faq-question">
                    <h3>How secure is this really?</h3>
                    <i class="fas fa-plus"></i>
                  </div>
                  <div class="faq-answer">
                    <p>The security has two layers:</p>
                    <ul>
                        <li><strong>Steganography (Covertness):</strong> Hiding the *existence* of the message. Enhanced LSB makes detection harder than basic LSB, but sophisticated steganalysis might still detect LSB modifications, especially at high payloads or with known cover images.</li>
                        <li><strong>Cryptography (Confidentiality):</strong> Using AES-256 encryption. This is extremely strong. Even if the hidden data is detected, it cannot be read without the correct 256-bit key.</li>
                    </ul>
                    <p>Overall security relies heavily on <strong>keeping the AES key secret</strong> and using **low payloads** in **complex cover images** saved in **lossless formats**.</p>
                  </div>
                </div>

                <div class="faq-item">
                  <div class="faq-question">
                    <h3>Which image formats should I use?</h3>
                    <i class="fas fa-plus"></i>
                  </div>
                  <div class="faq-answer">
                    <p>Use <strong>lossless formats like PNG or BMP</strong> for both the initial cover image and, critically, for saving the final stego-image. Using lossy formats like JPEG (JPG) will apply compression that alters pixel values and **irretrievably destroys the hidden LSB data.**</p>
                  </div>
                </div>

                 <div class="faq-item">
                  <div class="faq-question">
                    <h3>What's the maximum data I can hide?</h3>
                    <i class="fas fa-plus"></i>
                  </div>
                  <div class="faq-answer">
                    <p>The theoretical maximum capacity depends on the strategy:</p>
                     <ul>
                        <li><strong>Simple LSB:</strong> ~3 bits per pixel (bpp).</li>
                        <li><strong>Enhanced (Adaptive) LSB:</strong> ~2 bits per pixel (bpp).</li>
                    </ul>
                    <p>For a 1000x1000 pixel image (1 million pixels):</p>
                    <ul>
                        <li>Simple: ~ (1,000,000 * 3) / 8 = 375,000 bytes (~366 KB).</li>
                        <li>Enhanced: ~ (1,000,000 * 2) / 8 = 250,000 bytes (~244 KB).</li>
                    </ul>
                    <p><strong>Important:</strong> This is the raw capacity. The actual message size limit is smaller due to overhead (IV, Base64 encoding, header, optional embedded key). Furthermore, embedding near maximum capacity drastically increases the chance of detection. For better stealth, aim for much lower payloads (e.g., < 1 bpp).</p>
                  </div>
                </div>

                 <div class="faq-item">
                  <div class="faq-question">
                    <h3>Will resizing or editing the image break the hidden message?</h3>
                     <i class="fas fa-plus"></i>
                  </div>
                  <div class="faq-answer">
                    <p><strong>Almost certainly, yes.</strong> LSB steganography is extremely fragile because it relies on the exact values of the least significant bits.</p>
                    <p>Any operation that recalculates or modifies pixel values, including:</p>
                    <ul>
                        <li>Resizing, cropping, rotating</li>
                        <li>Applying filters or color adjustments</li>
                        <li>Saving in a lossy format (JPEG)</li>
                        <li>Uploading to many online platforms (social media, image hosts) that automatically re-compress or strip metadata</li>
                    </ul>
                    <p>...will likely corrupt or completely erase the data hidden in the LSBs. The stego-image file must be transmitted and stored without any such modifications.</p>
                  </div>
                </div>

                 <div class="faq-item">
                  <div class="faq-question">
                    <h3>Is using steganography legal?</h3>
                     <i class="fas fa-plus"></i>
                  </div>
                  <div class="faq-answer">
                    <p>The technology of steganography itself is neutral, like encryption. Its legality depends entirely on <strong>how and why</strong> it is used.</p>
                     <ul>
                        <li><strong>Legitimate Uses:</strong> Digital watermarking for copyright, embedding metadata for data association (e.g., medical images), enhancing privacy in specific contexts, or educational purposes are generally legal.</li>
                        <li><strong>Illegal Uses:</strong> Using steganography to conceal illicit activities, distribute malware, infringe copyright, bypass security measures, or engage in espionage is illegal and unethical.</li>
                    </ul>
                    <p>Always ensure your use complies with local laws, regulations, and ethical guidelines. Be aware that its use might attract suspicion in certain contexts.</p>
                  </div>
                </div>

                 <div class="faq-item">
                  <div class="faq-question">
                    <h3>What's the benefit of Enhanced (Adaptive) LSB over Simple LSB?</h3>
                     <i class="fas fa-plus"></i>
                  </div>
                  <div class="faq-answer">
                    <p>Enhanced (Adaptive) LSB aims primarily to improve <strong>imperceptibility</strong> (visual stealth) and <strong>resistance to basic statistical steganalysis</strong> compared to Simple LSB.</p>
                     <ul>
                        <li>It selectively chooses only 2 out of 3 color channels for embedding in each pixel, based on that pixel's brightness (intensity).</li>
                        <li>The goal is to make changes in areas where human vision is less sensitive (e.g., avoiding blue channel changes in very dark areas).</li>
                        <li>This non-uniform modification pattern also disrupts the predictable statistical changes caused by Simple LSB, making it harder for basic first-order statistical tests (like Chi-Square analysis) to detect anomalies.</li>
                    </ul>
                     <p>The main trade-off is a <strong>lower maximum payload capacity</strong> (~2 bpp vs ~3 bpp for Simple LSB).</p>
                  </div>
                </div>
              </div>
            </section>

            <!-- 16. Contributors Section -->
            <section id="contributors" class="section">
              <div class="section-header">
                <i class="fas fa-users"></i>
                <h2 data-toc="Contributors">Contributors</h2>
              </div>
              <p>This documentation page was generated and enhanced based on the provided application code and requirements.</p>

            
                    <div class="contributor-card">
                    <div class="contributor-avatar">
                        <i class="fas fa-code"></i>
                    </div>
                    <div class="contributor-info">
                        <h3>Original Developer(s)</h3>
                        <p>Authors of the Steganography App Code</p>
                         <div class="contributor-links"><a href="#"><i class="fab fa-github"></i></a></div>
                    </div>
                    </div>
                </div>

                 
            </section>
          
          </div> <!-- End Inner container -->
        </main> <!-- End Main Content -->

    </div> <!-- End Content Wrapper -->

    <!-- Footer -->
    <footer>
      <div class="footer-content">
        <p>Secure Message Steganography Documentation &copy; 2024</p>
        <p>Built upon Application Version 1.0.0</p>
        <div class="footer-links">
          <a href="https://github.com/YOUR_REPO_HERE" target="_blank" rel="noopener noreferrer"><i class="fab fa-github"></i> App Repository</a>
          
          <a href="resources.html"><i class="fas fa-book-open"></i> Resource Library</a>
          <a href="#hero"><i class="fas fa-arrow-up"></i> Back to Top</a>
           <a href="#"><i class="fas fa-bug"></i> Report Issue</a>
        </div>
      </div>
    </footer>
  </div> <!-- End Page Wrapper -->


  <!-- Back to top button -->
  <button id="backToTop" class="back-to-top" title="Back to Top">
    <i class="fas fa-arrow-up"></i>
  </button>

  <!-- Prism JS (Core + Components + Toolbar + Copy Button Plugin) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>


  <!-- Main JavaScript -->
  <script>
    // --- Global Elements ---
    const body = document.body;
    const themeToggle = document.getElementById('themeToggle');
    const backToTopButton = document.getElementById('backToTop');
    const tocElement = document.getElementById('toc');
    const tocList = document.getElementById('toc-list');
    const tocToggleMobile = document.getElementById('tocToggleMobile');
    const searchInput = document.getElementById('searchInput');
    const tocSearchResults = document.getElementById('toc-search-results');
    let sections = []; // Populated later for ToC highlighting
    let lunrIdx; // Lunr search index
    let documents = []; // Documents for Lunr

    // --- Theme Management ---
    const applyTheme = (theme) => {
      if (theme === 'dark') {
        body.classList.add('dark-mode');
        themeToggle.innerHTML = '<i class="fas fa-sun"></i><span class="sr-only">Activate Light Mode</span>';
        themeToggle.title = "Activate Light Mode";
      } else {
        body.classList.remove('dark-mode');
        themeToggle.innerHTML = '<i class="fas fa-moon"></i><span class="sr-only">Activate Dark Mode</span>';
         themeToggle.title = "Activate Dark Mode";
      }
       // Force Prism redraw after theme change if needed
       // if (typeof Prism !== 'undefined') { Prism.highlightAll(); }
    };

    const toggleTheme = () => {
      const newTheme = body.classList.contains('dark-mode') ? 'light' : 'dark';
      localStorage.setItem('theme', newTheme);
      applyTheme(newTheme);
    };

    const checkSystemPreference = () => {
      // Check for saved theme first
      const savedTheme = localStorage.getItem('theme');
       if (savedTheme) {
           return savedTheme;
       }
       // If no saved theme, check system preference
       if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
           return 'dark';
       }
       // Default to light if no preference or saved theme
      return 'light';
    };

    // --- ToC Generation & Highlighting ---
    const generateToc = () => {
      if (!tocList) return;
      tocList.innerHTML = ''; // Clear existing
      sections = []; // Reset sections array
      documents = []; // Reset search documents
      const sectionHeadings = document.querySelectorAll('.section h2[data-toc]');

      sectionHeadings.forEach((h2, index) => {
        const title = h2.getAttribute('data-toc') || h2.textContent;
        const id = h2.closest('section').id;
        if (!id) {
            console.warn("Section heading found without parent section ID:", h2);
            return; // Skip if section has no ID
        }

        const listItem = document.createElement('li');
        const link = document.createElement('a');
        link.href = `#${id}`;
        link.textContent = title;
        link.dataset.targetId = id; // Store target ID for highlighting
         // Close mobile ToC on click
         link.addEventListener('click', () => {
            if (tocElement && tocElement.classList.contains('show-mobile')) {
                 tocElement.classList.remove('show-mobile');
                 document.body.classList.remove('toc-open-mobile'); // Remove body class
            }
         });
        listItem.appendChild(link);
        tocList.appendChild(listItem);

        // For Scroll Highlighting
        const sectionElement = document.getElementById(id);
        if(sectionElement) {
            sections.push({ id: id, element: sectionElement, link: link });
        }

         // For Search Indexing
         const sectionText = sectionElement.innerText || sectionElement.textContent;
          documents.push({
            id: id,
            title: title,
            content: sectionText.substring(0, 5000) // Limit content length for index size
          });
      });
    };

    const highlightTocLink = () => {
       // Don't run if ToC is hidden (non-mobile) or sections not populated
      if (!sections.length || (window.innerWidth > 1200 && !tocElement)) return;

      let currentSectionId = null;
      const scrollPosition = window.pageYOffset || document.documentElement.scrollTop;
       // Offset to trigger highlight slightly before section top reaches viewport top
       // Adjust offset based on header height
       const headerHeight = document.querySelector('header')?.offsetHeight || 80;
      const highlightOffset = headerHeight + 50; // Header height + extra buffer

      // Find the current section based on scroll position
      for (let i = sections.length - 1; i >= 0; i--) {
          const section = sections[i];
          const sectionTop = section.element.offsetTop;
          if (scrollPosition >= sectionTop - highlightOffset) {
              currentSectionId = section.id;
              break; // Stop at the first section that meets the condition from bottom up
          }
      }

      // If near the top and no section matched, maybe highlight the first one
      if (currentSectionId === null && sections.length > 0 && scrollPosition < sections[0].element.offsetTop) {
          // Optionally highlight the first section, or none
          // currentSectionId = sections[0].id;
      }

      // If scrolled to the very bottom, highlight the last section
       if ((window.innerHeight + Math.ceil(scrollPosition)) >= document.body.offsetHeight && sections.length > 0) {
           currentSectionId = sections[sections.length - 1].id;
       }


      // Update active class on ToC links
      sections.forEach(section => {
        if (section.link) { // Ensure link exists
            if (section.id === currentSectionId) {
              section.link.classList.add('active');
            } else {
              section.link.classList.remove('active');
            }
        }
      });
    };


    // --- Search Functionality ---
    const initializeSearch = () => {
        if (typeof lunr === 'undefined') {
            console.error("Lunr.js not loaded.");
            if(searchInput) searchInput.disabled = true;
            return;
        }
        if (!documents || documents.length === 0) {
            console.warn("No documents found for Lunr index. Ensure ToC generation runs first.");
            return;
        }

        try {
            lunrIdx = lunr(function () {
                this.ref('id'); // Document reference
                this.field('title', { boost: 10 }); // Boost title matches
                this.field('content');

                documents.forEach(function (doc) {
                    this.add(doc);
                }, this);
            });
            console.log("Lunr index built with", documents.length, "documents.");
             if(searchInput) searchInput.disabled = false; // Enable search input
        } catch (e) {
            console.error("Error building Lunr index:", e);
             if(searchInput) searchInput.disabled = true;
        }

    };

    const performSearch = (query) => {
        if (!lunrIdx || !tocSearchResults || !tocList) return;
        tocSearchResults.innerHTML = ''; // Clear previous results

        if (!query || query.trim().length < 2) { // Min query length
             tocSearchResults.style.display = 'none';
             tocList.style.display = 'block'; // Show normal ToC
            return;
        }

         tocSearchResults.style.display = 'block';
         tocList.style.display = 'none'; // Hide normal ToC when showing results

        try {
            // Add wildcards for prefix/suffix matching
             const searchResults = lunrIdx.search(`*${query}* ${query}~1`); // Fuzzy match and wildcard
            const resultList = document.createElement('ul');

            if (searchResults.length > 0) {
                searchResults.slice(0, 7).forEach(result => { // Limit results shown
                    const doc = documents.find(d => d.id === result.ref);
                    if (doc) {
                        const listItem = document.createElement('li');
                        const link = document.createElement('a');
                        link.href = `#${doc.id}`;
                        link.textContent = doc.title;
                         link.addEventListener('click', () => { // Close mobile ToC on click
                            if (tocElement && tocElement.classList.contains('show-mobile')) {
                                tocElement.classList.remove('show-mobile');
                                 document.body.classList.remove('toc-open-mobile');
                            }
                         });
                        listItem.appendChild(link);
                        resultList.appendChild(listItem);
                    }
                });
                 tocSearchResults.appendChild(resultList);
            } else {
                tocSearchResults.innerHTML = '<p style="padding: 0 1rem;">No results found.</p>';
            }
        } catch (e) {
             console.error("Error during search:", e);
             tocSearchResults.innerHTML = '<p style="padding: 0 1rem;">Search error.</p>';
        }
    };


    // --- Flowchart / Section Tabs ---
    const initFlowchartTabs = () => {
        const containers = document.querySelectorAll('.flowchart-tabs, .tabbed-section-container .flowchart-tabs'); // Find all tab containers
        containers.forEach(container => {
             const tabs = container.querySelectorAll('.flowchart-tab');
             // Find content relative to the parent container of the tabs div
             const contentContainer = container.closest('.flowchart-container, .tabbed-section-container');
             if (!contentContainer) return;
             const contents = contentContainer.querySelectorAll(':scope > .flowchart-content'); // Direct children

            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // Deactivate siblings within the same tab group
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    const targetId = tab.getAttribute('data-target');

                    // Deactivate all content blocks within this container first
                    contents.forEach(content => {
                        content.classList.remove('active');
                    });
                     // Activate the target content block
                     const targetContent = contentContainer.querySelector(`#${targetId}`);
                     if (targetContent) {
                          targetContent.classList.add('active');
                     } else {
                         console.warn("Target content not found:", targetId);
                     }
                });
            });

            // Ensure the first tab's content is active by default if none are marked active
            const firstTab = container.querySelector('.flowchart-tab');
            const activeContent = contentContainer.querySelector('.flowchart-content.active');
            if (firstTab && !activeContent) {
                 const targetId = firstTab.getAttribute('data-target');
                 const targetContent = contentContainer.querySelector(`#${targetId}`);
                 if (targetContent) {
                    firstTab.classList.add('active');
                    targetContent.classList.add('active');
                 }
            }
        });
    };

    // --- Back to Top Button ---
    const handleScroll = () => {
      // Back to Top visibility
      if (backToTopButton) {
          if (window.pageYOffset > 300) {
            backToTopButton.classList.add('show');
          } else {
            backToTopButton.classList.remove('show');
          }
      }
      // ToC Highlighting (throttled might be better for performance)
      requestAnimationFrame(highlightTocLink);
    };

     // Debounce function
    function debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
            const later = () => {
            clearTimeout(timeout);
            func(...args);
            };
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
        };
    }

    // --- FAQ Accordion ---
    const initFAQ = () => {
      const faqItems = document.querySelectorAll('.faq-item');
      faqItems.forEach(item => {
        const question = item.querySelector('.faq-question');
        const answer = item.querySelector('.faq-answer');
        const icon = question.querySelector('i');
        if (!question || !answer || !icon) return;

        question.setAttribute('aria-expanded', 'false'); // Initial state
        answer.setAttribute('aria-hidden', 'true');

        question.addEventListener('click', () => {
          const isActive = item.classList.toggle('active');
          icon.classList.toggle('fa-plus', !isActive);
          icon.classList.toggle('fa-minus', isActive);
          question.setAttribute('aria-expanded', isActive);
          answer.setAttribute('aria-hidden', !isActive);

          // Optional: Close others for accordion behavior
          // if (isActive) {
          //     faqItems.forEach(otherItem => {
          //         if (otherItem !== item && otherItem.classList.contains('active')) {
          //             otherItem.classList.remove('active');
          //             otherItem.querySelector('.faq-question i').classList.remove('fa-minus');
          //             otherItem.querySelector('.faq-question i').classList.add('fa-plus');
          //             otherItem.querySelector('.faq-question').setAttribute('aria-expanded', 'false');
          //             otherItem.querySelector('.faq-answer').setAttribute('aria-hidden', 'true');
          //         }
          //     });
          // }
        });
      });
    };

    // --- Section Visibility Animation ---
    const handleSectionVisibility = () => {
      const sectionElements = document.querySelectorAll('.section');
      if (!('IntersectionObserver' in window)) {
        // Fallback for older browsers
        console.log("IntersectionObserver not supported, showing all sections.");
        sectionElements.forEach(section => section.classList.add('visible'));
        return;
      }

      const observer = new IntersectionObserver((entries, obs) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('visible');
            obs.unobserve(entry.target); // Stop observing once visible
          }
        });
      }, {
          threshold: 0.1, // Trigger when 10% is visible
          rootMargin: "0px 0px -50px 0px" // Trigger slightly before fully in view
      });

      sectionElements.forEach(section => {
         // Make first section visible immediately, observe others
         if (section.id === 'overview') {
             section.classList.add('visible');
         } else {
             observer.observe(section);
         }
      });
    };


    // --- Event Listeners ---
    themeToggle?.addEventListener('click', toggleTheme);
    backToTopButton?.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));
    window.addEventListener('scroll', handleScroll, { passive: true }); // Use passive listener

    // Mobile ToC Toggle Listener
    tocToggleMobile?.addEventListener('click', () => {
         if (tocElement) {
             tocElement.classList.toggle('show-mobile');
             // Add class to body to prevent scroll when ToC is open on mobile
             document.body.classList.toggle('toc-open-mobile', tocElement.classList.contains('show-mobile'));
         }
     });

     // Close mobile ToC if clicking outside of it
     document.addEventListener('click', (event) => {
         if (tocElement?.classList.contains('show-mobile') &&
             !tocElement.contains(event.target) &&
             !tocToggleMobile?.contains(event.target)) {
             tocElement.classList.remove('show-mobile');
             document.body.classList.remove('toc-open-mobile');
         }
     });


     // Search Input Listener (Debounced)
     const debouncedSearch = debounce(performSearch, 250); // Debounce search input
     searchInput?.addEventListener('input', (e) => {
         debouncedSearch(e.target.value);
     });


    // --- Initialization ---
    document.addEventListener('DOMContentLoaded', () => {
      applyTheme(checkSystemPreference());
      generateToc(); // Generate ToC first
      initializeSearch(); // Initialize search after ToC/docs are ready
      initFlowchartTabs();
      initFAQ();
      handleSectionVisibility();
      if (typeof Prism !== 'undefined') {
          Prism.highlightAll(); // Initialize Prism syntax highlighting
      } else {
          console.warn("Prism.js not loaded.");
      }
       highlightTocLink(); // Initial highlight check
    });

  </script>

  <!-- React components script -->
  <script type="text/babel">
    // --- LSB Steganography Demo Component ---
    const LSBSteganographyDemo = () => {
      const [pixelBits, setPixelBits] = React.useState([
        ['1', '0', '1', '0', '1', '1', '1', '0'], // 174
        ['0', '1', '0', '1', '0', '0', '1', '1'], // 83
        ['1', '1', '0', '0', '1', '0', '1', '0']  // 202
      ]);
      const [secretBits, setSecretBits] = React.useState(['1', '0', '1']);
      const [showModified, setShowModified] = React.useState(false);
      const [showStep, setShowStep] = React.useState(0);

      const channelColors = ['#f87171', '#4ade80', '#60a5fa']; // Red, Green, Blue
      const channelNames = ['Red', 'Green', 'Blue'];

      const getModifiedPixels = () => {
        const modified = JSON.parse(JSON.stringify(pixelBits));
        secretBits.forEach((bit, i) => {
          if (modified[i] && modified[i].length === 8) {
            modified[i][7] = bit; // Replace LSB
          }
        });
        return modified;
      };

      const binToDec = (binArray) => parseInt(binArray.join(''), 2);

      const handleReset = () => {
        setShowStep(0);
        setShowModified(false);
      };

      const handleNextStep = () => {
        if (showStep < 3) {
          const nextStep = showStep + 1;
          setShowStep(nextStep);
          if (nextStep === 3) {
            setShowModified(true);
          }
        }
      };

      return (
        <div className="demo-container">
          <h3>LSB Steganography Visualization</h3>
           <p className="comparison-description" style={{textAlign: 'center', marginBottom: '2rem'}}>Step through the process of hiding the secret bits '101' into the LSBs of a single pixel's RGB values.</p>

          <div className="demo-content">
            {/* Original Pixels */}
            <div className="original-pixels">
              <h4>Original Pixel Values</h4>
              <div className="channels">
                {pixelBits.map((channel, i) => (
                  <div key={i} className="channel">
                    <div className="channel-label" style={{ color: channelColors[i] }}>
                      <div className="color-box" style={{ backgroundColor: channelColors[i] }}></div>
                      <span>{channelNames[i]} (Value: {binToDec(channel)})</span>
                    </div>
                    <div className="bits">
                      {channel.map((bit, j) => (
                        <div
                          key={j}
                          className={`bit ${j === 7 ? 'lsb' : ''} ${j === 7 && showStep >= 2 && i < secretBits.length ? 'highlight' : ''}`}
                          title={j === 7 ? 'Least Significant Bit (LSB)' : `Bit ${7-j}`}
                        >
                          {bit}
                        </div>
                      ))}
                       {j === 7 && i === 0 && ( // Show label only once
                            <div className="lsb-label" style={{ visibility: showStep >= 1 ? 'visible' : 'hidden', opacity: showStep >=1 ? 1 : 0 }}> LSB</div>
                        )}
                    </div>
                  </div>
                ))}
              </div>
            </div>

            {/* Modified Pixels (Conditional) */}
             <div className="modified-pixels" style={{ opacity: showModified ? 1 : 0.3, transform: showModified ? 'translateX(0)' : 'translateX(20px)', transition: 'opacity 0.5s ease, transform 0.5s ease' }}>
                <h4>Modified Pixel Values</h4>
                <div className="channels">
                  {getModifiedPixels().map((channel, i) => (
                    <div key={i} className="channel">
                       <div className="channel-label" style={{ color: channelColors[i] }}>
                         <div className="color-box" style={{ backgroundColor: channelColors[i] }}></div>
                         <span>{channelNames[i]} (Value: {binToDec(channel)})</span>
                       </div>
                      <div className="bits">
                        {channel.map((bit, j) => (
                          <div key={j} className={`bit ${j === 7 && i < secretBits.length ? 'lsb modified' : (j === 7 ? 'lsb' : '')}`}>
                            {bit}
                          </div>
                        ))}
                        {i < secretBits.length && (
                            <div className="lsb-label" style={{color: 'var(--success)', visibility: showStep === 3 ? 'visible' : 'hidden', opacity: showStep === 3 ? 1 : 0 }}>
                                 Bit '{secretBits[i]}' Embedded
                            </div>
                       )}
                      </div>
                    </div>
                  ))}
                </div>
              </div>
          </div>

           {/* Controls and Explanation */}
           <div style={{display: 'flex', gap: '2rem', marginTop: '2rem', flexWrap: 'wrap', alignItems: 'center'}}>
                <div className="secret-data" style={{flexBasis: '30%', minWidth: '200px'}}>
                    <h4>Secret Bits to Hide</h4>
                    <div className="secret-bits" style={{justifyContent: 'center'}}>
                    {secretBits.map((bit, i) => (
                        <div key={i} className={`bit ${showStep >= 2 && showStep <= 3 && i < secretBits.length ? 'highlight' : ''}`} style={{borderColor: showStep >= 2 && showStep < 3 && i < secretBits.length ? 'var(--accent)' : 'var(--card-border)'}}>{bit}</div>
                    ))}
                    </div>
                </div>

                <div className="explanation-box" style={{flex: 1}}>
                    <h4>Explanation Step {showStep}/3</h4>
                    <p style={{minHeight: '4em'}}> {/* Min height for consistent layout */}
                    {showStep === 0 && "Initial 8-bit values for the Red, Green, and Blue channels of a pixel. Click 'Next Step' to identify the LSBs."}
                    {showStep === 1 && "The rightmost bit in each byte is the Least Significant Bit (LSB). Changing it minimally affects the overall color value (1)."}
                    {showStep === 2 && "LSB Steganography works by replacing these LSBs (highlighted red) with the secret data bits (highlighted purple)."}
                    {showStep === 3 && "The LSBs are now replaced with '101'. Notice the minimal change in decimal values (e.g., Red 174  175). This tiny difference is usually imperceptible visually. Click Reset to start over."}
                    </p>
                </div>
           </div>

          <div className="demo-controls" style={{marginTop: '1.5rem'}}>
            <button onClick={handleReset} className="reset-button">
              <i className="fas fa-undo" style={{ marginRight: '0.5em' }}></i> Reset
            </button>
            <button
              onClick={handleNextStep}
              disabled={showStep === 3}
              className={`next-button ${showStep === 3 ? 'disabled' : ''}`}
            >
              {showStep < 3 ? `Next Step (${showStep + 1}/3)` : 'Demo Complete'} <i className="fas fa-arrow-right" style={{ marginLeft: '0.5em' }}></i>
            </button>
          </div>
        </div>
      );
    };

    // --- Image Comparison Slider Component ---
    const ImageComparisonSlider = () => {
      const [sliderPosition, setSliderPosition] = React.useState(50);
      const [isDragging, setIsDragging] = React.useState(false);
      const containerRef = React.useRef(null);
      // Placeholder image state (replace with actual upload logic later)
      const [originalImgSrc, setOriginalImgSrc] = React.useState("https://placekitten.com/800/600?image=5");
      const [stegoImgSrc, setStegoImgSrc] = React.useState("https://placekitten.com/g/800/600?image=5"); // Grayscale placeholder

      // Example metrics (update if real calculation occurs)
      const psnrValue = 42.8;
      const ssimValue = 0.9872;

      const startDragging = React.useCallback((e) => {
         // Prevent text selection during drag
        e.preventDefault();
        setIsDragging(true);
        document.body.style.cursor = 'ew-resize';
        document.body.style.userSelect = 'none';
      }, []);

      const stopDragging = React.useCallback(() => {
        if (isDragging) {
          setIsDragging(false);
           document.body.style.cursor = '';
           document.body.style.userSelect = '';
        }
      }, [isDragging]);

      const onDragging = React.useCallback((clientX) => {
        if (!isDragging || !containerRef.current) return;
        const rect = containerRef.current.getBoundingClientRect();
        let newX = clientX - rect.left;
        let newPosition = (newX / rect.width) * 100;
        // Clamp position between 0 and 100
        setSliderPosition(Math.max(0, Math.min(100, newPosition)));
      }, [isDragging]);

      // Add/remove global event listeners for mouse/touch move/end
      React.useEffect(() => {
        const handleMouseMove = (e) => onDragging(e.clientX);
        const handleTouchMove = (e) => {
            // Prevent page scroll on touch devices while dragging
            e.preventDefault();
            if (e.touches.length === 1) onDragging(e.touches[0].clientX);
        };

        if (isDragging) {
          window.addEventListener('mousemove', handleMouseMove);
          window.addEventListener('mouseup', stopDragging);
          window.addEventListener('touchmove', handleTouchMove, { passive: false }); // Need passive false to prevent scroll
          window.addEventListener('touchend', stopDragging);
        }

        // Cleanup function
        return () => {
          window.removeEventListener('mousemove', handleMouseMove);
          window.removeEventListener('mouseup', stopDragging);
           window.removeEventListener('touchmove', handleTouchMove);
           window.removeEventListener('touchend', stopDragging);
           // Ensure cursor and userSelect are reset if component unmounts while dragging
           document.body.style.cursor = '';
           document.body.style.userSelect = '';
        };
      }, [isDragging, onDragging, stopDragging]);

       // Placeholder for file handling (to be implemented fully later)
      const handleFileChange = (event, type) => {
          const file = event.target.files[0];
          if (file && file.type.startsWith('image/')) {
              const reader = new FileReader();
              reader.onload = (e) => {
                  if (type === 'original') {
                      setOriginalImgSrc(e.target.result);
                  } else {
                      setStegoImgSrc(e.target.result);
                  }
              };
              reader.readAsDataURL(file);
              console.log(`Placeholder: ${type} image selected - ${file.name}. Displaying preview.`);
              // TODO: Add logic here to potentially trigger backend processing or JS-based stego simulation
          } else {
              console.warn("Invalid file type selected.");
          }
      };

      return (
        <div className="comparison-container">
          <h3>Before & After Comparison</h3>
          <p className="comparison-description">
            Drag the slider (<i className="fas fa-arrows-alt-h"></i>) to compare the original image (left) with the stego image (right). High PSNR/SSIM values indicate minimal visual difference. You can upload your own images below (feature in development).
          </p>

          {/* Upload Areas (Placeholders) */}
           <div style={{ display: 'flex', justifyContent: 'center', gap: '2rem', marginBottom: '1.5rem', flexWrap: 'wrap' }}>
              <div className="demo-upload-area" style={{ margin: 0, padding: '1rem', maxWidth: '300px' }}>
                  <label htmlFor="originalUpload" className="demo-button" style={{ display: 'inline-block', padding: '0.5rem 1rem', fontSize: '0.9rem' }}>Choose Original</label>
                  <input type="file" id="originalUpload" accept="image/png, image/bmp" onChange={(e) => handleFileChange(e, 'original')} />
                  <p>Upload Original (PNG/BMP)</p>
              </div>
              <div className="demo-upload-area" style={{ margin: 0, padding: '1rem', maxWidth: '300px' }}>
                  <label htmlFor="stegoUpload" className="demo-button" style={{ display: 'inline-block', padding: '0.5rem 1rem', fontSize: '0.9rem' }}>Choose Stego</label>
                  <input type="file" id="stegoUpload" accept="image/png, image/bmp" onChange={(e) => handleFileChange(e, 'stego')} />
                   <p>Upload Stego (PNG/BMP)</p>
              </div>
           </div>

          <div
            className="slider-container"
            ref={containerRef}
            onMouseDown={startDragging}
            onTouchStart={startDragging} // Add touch start event
            style={{ touchAction: 'none' }} // Prevent default touch actions like scroll when dragging slider
          >
            <div className="original-image">
                 <img src={originalImgSrc} alt="Original Image" loading="lazy" />
                 <div className="image-label original-label">Original</div>
            </div>
            <div className="stego-image" style={{ clipPath: `inset(0 ${100 - sliderPosition}% 0 0)` }}>
                 <img src={stegoImgSrc} alt="Stego Image" loading="lazy" />
                  <div className="image-label stego-label">Stego</div>
            </div>
            <div className="slider-divider" style={{ left: `${sliderPosition}%` }}>
              <div className="slider-handle" title="Drag to Compare">
                <div className="slider-arrows">
                  <i className="fas fa-chevron-left"></i>
                  <i className="fas fa-chevron-right"></i>
                </div>
              </div>
            </div>
          </div>

          {/* Metrics Display */}
           <div className="metrics-display">
            <div className="metric">
              <h4>PSNR</h4>
              <div className="metric-value">{psnrValue.toFixed(2)} dB</div>
              <div className="metric-description">Higher = less distortion. >40dB is excellent.</div>
            </div>
            <div className="metric">
              <h4>SSIM</h4>
              <div className="metric-value">{ssimValue.toFixed(4)}</div>
              <div className="metric-description">Closer to 1 = more similar. >0.98 is excellent.</div>
            </div>
          </div>
        </div>
      );
    };


    // --- Adaptive Channel Visualization Component ---
     const AdaptiveChannelVisualization = () => {
      const [intensity, setIntensity] = React.useState(120); // Default: Medium

      const getActiveChannels = (currentIntensity) => {
        if (currentIntensity < 85) return ['Red', 'Green'];    // Dark: Use R, G
        if (currentIntensity < 170) return ['Green', 'Blue']; // Medium: Use G, B
        return ['Red', 'Blue'];                                // Bright: Use R, B
      };

      const getIntensityCategory = (currentIntensity) => {
        if (currentIntensity < 85) return 'Dark';
        if (currentIntensity < 170) return 'Medium';
        return 'Bright';
      };

      const activeChannels = getActiveChannels(intensity);
      const category = getIntensityCategory(intensity);
      const bgColor = `rgb(${intensity}, ${intensity}, ${intensity})`;
      // Choose text color based on background intensity for better contrast
      const textColor = intensity > 128 ? '#111' : '#eee';

      return (
        <div className="adaptive-channel-container">
          <h3>Adaptive Channel Selection (Enhanced LSB)</h3>
          <p className="description">
            Enhanced LSB selects *two* specific color channels (R, G, or B) to hide data in, based on the pixel's overall brightness (intensity). This aims for better visual stealth. Drag the slider to simulate different pixel intensities.
          </p>

          <div className="adaptive-content">
            {/* Intensity Control */}
            <div className="intensity-section">
              <h4>Simulate Pixel Intensity</h4>
              <div className="intensity-slider">
                <input
                  type="range" min="0" max="255" value={intensity}
                  onChange={(e) => setIntensity(parseInt(e.target.value))}
                  aria-label="Pixel Intensity"
                />
                <div className="range-labels"><span>Dark (0)</span><span>Bright (255)</span></div>
              </div>
              <div className="intensity-display" style={{ backgroundColor: bgColor }}>
                <span className="intensity-value" style={{ color: textColor }}>{intensity}</span>
                <div className="intensity-label" style={{ color: textColor }}>{category} Pixel Area</div>
              </div>
            </div>

            {/* Channel Selection Display */}
            <div className="channels-section">
               <h4>Selected Channels for Embedding</h4>
               <p>For this <strong>{category.toLowerCase()}</strong> pixel (intensity: {intensity}), Enhanced LSB would hide data bits in the LSBs of the following channels:</p>
              <div className="channel-list">
                {['Red', 'Green', 'Blue'].map(channelName => (
                  <div key={channelName} className={`channel-item ${activeChannels.includes(channelName) ? 'active' : ''}`}>
                    <div className={`channel-color ${channelName.toLowerCase()}`}></div>
                    <span className="channel-name">
                      {channelName} Channel {activeChannels.includes(channelName) ? <strong style={{ color: 'var(--success)' }}>(USED)</strong> : '(Skipped)'}
                    </span>
                  </div>
                ))}
              </div>
            </div>
          </div>

          {/* Rationale Box */}
            <div className="explanation-box" style={{marginTop: '2rem'}}>
                <h4>Rationale (Perceptual Hiding)</h4>
                <div className="explanation-items">
                <div className="explanation-item">
                    <div className="dot dark"></div>
                    <p><strong>Dark Pixels (&lt;85):</strong> Use <strong>R + G</strong>. Human vision is less sensitive to changes in the Blue channel in dark areas.</p>
                </div>
                <div className="explanation-item">
                    <div className="dot medium"></div>
                    <p><strong>Medium Pixels (85-170):</strong> Use <strong>G + B</strong>. Green channel often carries significant luminance detail; modifying Red might be more noticeable here.</p>
                </div>
                <div className="explanation-item">
                    <div className="dot bright"></div>
                    <p><strong>Bright Pixels (&gt;170):</strong> Use <strong>R + B</strong>. In very bright areas, changes in the Green channel might be less perceptible.</p>
                </div>
                </div>
                <p style={{marginTop: '1rem', fontSize: '0.9em', opacity: 0.8}}>This strategy leverages quirks of human visual perception to minimize the visibility of LSB changes compared to naively using all three channels (Simple LSB).</p>
            </div>

        </div>
      );
    };


    // --- Mount React Components ---
    document.addEventListener('DOMContentLoaded', function() {
      const lsbDemoRootElement = document.getElementById('lsb-demo-container');
      const comparisonRootElement = document.getElementById('image-comparison-container');
      const adaptiveRootElement = document.getElementById('adaptive-channel-container');

      // Use React 18 createRoot API
      const createRootIfExists = (element, Component) => {
         if (element) {
             ReactDOM.createRoot(element).render(<Component />);
         } else {
              console.warn("React mount point not found for", Component.name);
         }
      };

      createRootIfExists(lsbDemoRootElement, LSBSteganographyDemo);
      createRootIfExists(comparisonRootElement, ImageComparisonSlider);
      createRootIfExists(adaptiveRootElement, AdaptiveChannelVisualization);
    });
  </script>

</body>
</html>
